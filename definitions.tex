


\section{Well-structured transition systems}\label{section definitions}



%   In this section, we introduce general notations and preliminary definitions.

%The model we are interested in is labeled WSTS (and later some particular instances, i.e. Timed/Counter Automata for instance).


% \textcolor{red}{Before defining WSTS, need a definition of TS and WQO}

\noindent
%Let us recall the well-known framework of transition systems. 
 A {\em transition system} is a pair $\mathscr{S} = (S,\rightarrow )$ where $S$ is a set of 
 {\em states} and  
 $ {\rightarrow} \subseteq S \times S$ is a
 binary relation 
 on
 the set of states, denoted as the set of {\em transitions}. 
%
\iffalse
\mathieu{ Maybe add this back ?
A {\em labeled transition system} (LTS for short) is a tuple $\mathscr{S}=(S, \Sigma, \rightarrow)$ where 
$S$ is a set of {\em states}, $\Sigma$ is a (finite) set of {\em labels}, and 
${\rightarrow} \subseteq S\times \Sigma \times S$ is a 
ternary relation,
denoted as the set of {\em labeled transitions}. }
\fi
%
% We prefer to use infix notation and $(s,a ,s')\in {\rightarrow} $ will be abbreviated as    $s  \xrightarrow{a}  s'$ to represent a transition from configuration $s$ to configuration $s'$ with label $a$. 
We write $s \rightarrow s'$ to denote $ (s,s') \in  {\rightarrow} $.
We write $\rightarrow^{k}$, $\rightarrow^{+}$, $\rightarrow^{=}$, $\rightarrow^{*}$
for the $k$-step iteration of $\rightarrow$, its transitive closure, its reflexive closure, its reflexive and transitive closure.
Let $X,Y \subseteq S$ and $k \in \mathbb{N}$. We denote $X \longrightarrow^{*} Y$ (resp. $X \longrightarrow^{\leq k} Y$) if from all states $x \in X$ there exists a path (resp. of length smaller than $k$) that reaches a state $y \in Y$.
\noindent
The set of {\em (immediate) successors} of a state $s \in S$ is defined as 
 $\post(s) = \{ s' \in S \mid  ~ s \xrightarrow{} s'\}$. 
% $\post(s) = \{ s' \in S \mid  ~ \exists a \in \Sigma~ s \xrightarrow{a} s'\}$. 
%A state without successors is called a {\em dead end}. 
The set of {\em (immediate) predecessors} of a state $s \in S$ is deﬁned as
 $\pred(s) = \{ s' \in S \mid  ~ s' \xrightarrow{} s\}$. 
% $\pred(s) = \{ s' \in S \mid  ~ \exists a \in \Sigma~ s' \xrightarrow{a} s\}$. 
By iterating $\pred$ and $\post$ we obtain  
$\post^n(s) = \{ s' \in S \mid  ~ s \xrightarrow{}^n s'\}$
and
$\pred^n(s) = \{ s' \in S \mid  ~ s' \xrightarrow{}^n s\}$.
However, we are generally more interested in
$\post^{\leq n}(s) = \bigcup_{1 \leq i \leq n} \post^i(s)$, $\post^*(s)= \bigcup_{1 \leq i} \post^i(s)$
and
$\pred^{\leq n}(s) = \bigcup_{1 \leq i \leq n} \pred^i(s)$ and $\pred^*(s) = \bigcup_{1 \leq i} \pred^i(s)$. % \\
\alain{supprimer ce qui est inutile}

The {\em reachability problem} asks, given a transition system $\mathscr{S} = (S, \to)$, two configurations $s, t \in S$, whether $s \to^* t$. It is equivalent to
$s \in \pred^*(t)$ ? or $t \in \post^*(s)$ ? 
\alain{où est-ce utilisé ?}


%

\noindent
A {\em quasi-ordering} (a qo) is any reflexive and transitive relation $\leq$ over some set $X$ and we often write $(X,\leq)$. 
%\alain{utilisé ? We abbreviate $x \leq y \not\leq x$ by $x < y$.}
% A partial ordering (a po) is an antisymmetric qo
	% \alain{
Any qo induces an equivalence relation ($x \equiv y$ iff $x \leq y \leq x$).
 \alain{utilisé ?}
%
% and gives rise to a po between the equivalence classes ?
% 	do we need po ?
Given $(X,\leq)$ a quasi-ordering, an {\em upward-closed set} is any set $U \subseteq X$ such that if $y \geq x$ and $x \in U$ then $y \in U $.
A {\em downward-closed set} is any set $D \subseteq X$ such that if $y \leq x$ and $x \in D$ then $y \in D $. 
It is an {\em ideal } if it is also {\em directed}, i.e. it is nonempty and for every $a,b \in D$, there exists $c \in D$ such that $a \leq c$ and $b \leq c$.
To any subset $A \subseteq X$, we may associate
its {\em upward-closure},
 $\uparrow A = \{x \in X \mid \exists a \in A ~ y \geq a\}$
 and its 
 {\em downward-closure},
 $\downarrow A = \{x \in X \mid \exists a \in A ~ y \leq a\}$. 
We abbreviate $\uparrow \{x\}$ (resp. $\downarrow \{x\}$)
as $\uparrow x$ (resp. $\downarrow x$).
%
A {\em basis} of an upward-closed set $I$ is a set $I_b$ such that $I = \uparrow I_b$. 

\begin{definition}
 A {\em well-quasi-ordering} (wqo) is any quasi-ordering $(X,\leq)$ such that, for any infinite sequence $x_0, x_1, x_2, ...$ in $X$, there exist indexes $i \leq j$ with $x_i \leq  x_j$.
\end{definition}
%
% \textcolor{red}{Add lemma about infinite increasing subsequences ?}
%
\iffalse
%
\begin{lemma}
(Erd\"os and Rado). Assume $\leq$ is a wqo. Then any infinite sequence contains an infinite increasing subsequence: $x_{i_0} \leq x_{i_1} \leq x_{i_2} \cdots$ (with $i_0 < i_1 < i_2 \cdots$).
\end{lemma}


\begin{proof}
Consider an infinite sequence and the set $M = \{i \in N \mid \forall j > i ~ x_i \not\leq x_j \}$. $M$ cannot
be infinite, otherwise it would lead to an infinite subsequence contradicting the wqo
hypothesis. Thus, $M$ is bounded and any $x_i$ with $i$ beyond $M$ can start an infinite
increasing subsequence.
\end{proof}
%
\fi
%


% Higman investigated ordered sets with the finite basis property.

Wqo admits many other equivalent formulations. For instance: 
$(X,\leq)$ is a wqo f and only if any infinite sequence  $x_0, x_1, x_2, ...$ in $X$ contains an infinite increasing subsequence: $x_{i_0} \leq x_{i_1} \leq x_{i_2} \cdots$ (with $i_0 < i_1 < i_2 \cdots$)
if and only if any infinite increasing sequence $U_0 \subseteq U_1 \subseteq U_2 \subseteq \cdots$ of
upward-closed subsets in $X$ eventually stabilizes, 
%      i.e. there is a $k \in N$ such that $U_k = U_{k+1} = U_{k+2} = \cdots $ 
if and only if any upward-closed subset $U \subseteq X$ has a
finite basis if and only if $(X,\leq)$ is well-founded (i.e. it admits no infinite strictly decreasing sequence) and $X$ don't contain infinite subset of mutually incomparable elements (antichains).
%
\iffalse
%

\begin{lemma}{(Higman [40])} 
If $\leq$ is a wqo then any upward-closed $I$ has a
finite basis.
\end{lemma}

% \textcolor{red}{Expliquer ce que c'est une base d'abords.}

\begin{proof}
The set of minimal elements of $I$ is a basis because $\leq$ is well-founded. It
only contains a finite number of non-equivalent elements otherwise they would make
an infinite sequence contradicting the wqo assumption.
\end{proof}



\begin{lemma}  \label{upward-closed stablizes}
If $\leq$ is a wqo then any infinite increasing sequence $I_0 \subseteq I_1 \subseteq I_2 \subseteq \cdots$ of
upward-closed sets eventually stabilizes, i.e. there is a $k \in N$ such that 
$I_k = I_{k+1} = I_{k+2} = \cdots $.
\end{lemma}

\begin{proof}
Assue we have a counter-example.
We extract an infinite subsequence where
inclusion is strict: $I_{n_0} \subsetneq I_{n_1} \subsetneq I_{n_2} \cdots$. Now, for any $i>0$, we can pick some $x_i \in I_{n_i} \setminus I_{n_{i-1}}$. The well-quasi-ordering hypothesis means that the infinite sequence of $x_i$'s
contains an increasing pair $x_i \leq x_j$ for some $i<j$. Because $x_i$ belongs to an upward-
closed set $I_{n_i}$ we have $x_j \in I_{n_i} $, contradicting $x_j \not\in I_{n_{ j - 1}}$.
\end{proof}
%
\fi
%

\noindent
Quasi-orderings that have no infinite antichains enjoy a similar \emph{finite decomposition} property than wqo: every downward-closed subset $D \subseteq X$ can be decomposed into a \emph{finite} set of ideals $J_1, J_2,..., J_n$ (an ideal is a directed downward-closed subset) such that $D = \downarrow (J_1 \cup J_2 \cup..\cup J_n)$.

In what follows, a downward-closed set $D$ is represented by its finite set of ideals (or by the minimal elements of its upward-closed complement).
%		$D=\downarrow D$   $I_D=\{J_1, J_2,...,J_n\}$ 		satisfying $D = \downarrow (J_1 \cup J_2 \cup..\cup J_n)$ 
and an upward-closed set $U$ is represented by its finite set of minimal elements. \\
% $M_U$ of its  satisfying $U=\uparrow M_U$.

\noindent
Let us now recall the (most general) definition of well-structured transition systems.

\begin{definition}\cite{DBLP:journals/iandc/Finkel90,DBLP:journals/tcs/FinkelS01}
A {\em well-structured transition system} (WSTS)  $\mathscr{S}=(S, \rightarrow, \leq)$
is a transition system $(S, \rightarrow)$
equipped with a wqo ${\leq} \subseteq S \times S$ such that  
%  decidable ≤  wqo on S, i.e., for each two given states s, s ′ ∈ S, it is decidable whether s ≤ s ′ . 
the transition relation $ \rightarrow$ is (upward) compatible with $\leq$, i.e., for all 
$s_1, t_1 , s_2 \in S$
	with $s_1 \leq s_2$  and $s_1 \rightarrow t_1$, there exists 
	$t_2 \in S$ with 
	$t_1 \leq t_2$ and $s_2 \rightarrow^{*} t_2$.
\end{definition}

We say that a WSTS $\mathscr{S}$ has the \emph{strong (upward) compatibility} when moreover for all 
$s_1, t_1 , s_2 \in S$
	with $s_1 \leq s_2$  and $s_1 \rightarrow t_1$, there exists 
	$t_2 \in S$ with 
	$t_1 \leq t_2$ and $s_2 \rightarrow t_2$.

Several families of formal models of processes give rise to WSTSs in a natural way, e.g. Petri nets when inclusion between markings is used as the well-ordering and lossy channel systems with the subword ordering.


% \textcolor{red}{Define 'has effective pred-basis'. Maybe it should be included in WSTS definition, maybe it can be another def. I kind of like the idea of 'effective pred-basis' and 'decidable $\leq$' being independant from the WSTS definition}
\iffalse
\begin{proposition}\cite{DBLP:journals/tcs/FinkelS01}
If $\mathscr{S}$ is an WSTS and $U \subseteq S$ is an upward-closed set of states, then $\pred^*(U )$ is upward-
closed.
\end{proposition}
%
Proof. Assume $s \in \pred^* (U )$. Then $s \rightarrow^* t$ for some $t \in U $. If now $s' \geq s$ then upward-compatibility entails that $s' \rightarrow^* t'$ for some $t' \geq t$. Then $t' \in U$ and $s' \in \pred^*(U )$.
\fi

\noindent
{\bf On effectivity}
Let a WSTS $\mathscr{S}=(S, \rightarrow, \leq)$. We say that $\mathscr{S}$ is {\em effective} if there exists a pair of algorithms
($M_\rightarrow$, $M_\leq$) operating on $\N \times \N$ such that
$ M_\rightarrow$ computes the transition relation “$\rightarrow$” and 
$M_\leq$ the ordering relation “$\leq$”.
We say that $\mathscr{S}$ is {\em post-effective} if it is effective, and if there
exists an algorithm that computes $|\post(x)| \in \N \cup \{\infty\}$ 
on input $x$, with $x \in X_i $. 
We say that $\mathscr{S}$ has {\em effective pred-basis} \cite{DBLP:journals/tcs/FinkelS01,DBLP:journals/iandc/AbdullaCJT00} if there exists an algorithm accepting
any state $s \in S$ and returning $pb(s)$, a finite basis of $\uparrow \pred(\uparrow s)$.
%
We say that $\mathscr{S}$
is {\em ideally effective} \cite{BFM-ic17} if (1) the function mapping the encoding of a configuration $s$
to the encoding of the ideal $\downarrow s$ is computable; (2) inclusion of ideals is decidable; (3) the downward closure $\downarrow \post(I)$ expressed as a finite union of ideals is computable from the ideal $I$.

%\alain{étrange ces deux propositions, l'une suffirait}
%%%%%%%%%%%%%%%%%
\iffalse
%%%%%%%%%%%%%
Proof. Assume $s \in \pred (I )$. Then $s \rightarrow t$ for some $t \in I $. If now $s' \geq s$ then strong upward-compatibility entails that $s' \rightarrow t'$ for some $t' \geq t$. Then $t' \in I$ and $s' \in \pred(I )$.
%%%%%%%%%%%
\fi
%%%%%%%%%%

Now, we may recall a simple condition that insures that a finite basis of $\pred^*(\uparrow s )$ is computable for every $s \in S$.


We will use the following property: if $\mathscr{S}$ is a WSTS with strong compatibility and $U \subseteq S$ is upward-closed, then $\pred(U )$, $\pred^k(U )$ with $k\geq0$, and $\pred^*(U )$ are all upward-closed \cite{DBLP:journals/tcs/FinkelS01}.

For a WSTS $\mathscr{S}=(S, \rightarrow, \leq)$ and an upward-closed set $U  \subseteq S$, let us study the convergence of the sequence defined by $U_0=U$ and $U_k= U_{k-1} \cup \pred(U_{k-1})$ for $k \geq 1$. When $\mathscr{S}$ has the strong compatibility, the sets $U_k$ are upward-closed and $U_k \subseteq U_{k+1}$ so we know that the sequence $(U_k)_k$ converges. Let us define the \emph{index} of convergence of the sequence $U_k$ as the smallest $k_0$ s.t. $U_k = U_{k_0}$ for all $k \geq k_0$. We may compute $k_0$ and we then have:  $\pred^*(U) = U_{k_0}$. \\

With the effective pred-basis hypothese, we obtain:

\begin{theorem}\cite{DBLP:journals/tcs/FinkelS01,DBLP:journals/iandc/AbdullaCJT00}
A finite basis of $ \pred^*(U)$ is computable for any effective WSTS $\mathscr{S}=(S, \rightarrow, \leq)$ with effective pred-basis and any upward-closed set $U \subseteq S$ given with its finite basis $B_U$. Hence coverability is decidable.
\end{theorem}

With the ideally effective hypothese, we obtain the decidability of coverability for a class of ordered transition systems larger than WSTS.

\begin{theorem}\cite{BFM-ic17}
Coverability is decidable for any ideally effective ordered upward-compatible transition system $\mathscr{S}=(S, \rightarrow, \leq)$ where $\leq$ is without infinite antichains.
\end{theorem}






