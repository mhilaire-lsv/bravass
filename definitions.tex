

\section{Definitions}\label{section definitions}



In this section, we introduce general notations and preliminary definitions.

The model we are interested in is (S)WSTS (and later some particular instances, i.e. Timed/Counter Automata for instance).


% \textcolor{red}{Before defining WSTS, need a definition of TS and WQO}


\subsection{Transition systems}


\begin{definition}
A {\em labeled transition system} (LTS for short) is a tuple $\mathscr{S}=(S, \Lambda, \rightarrow)$ where 
$S$ is a set of {\em states}, $ \Lambda$ is a set of {\em labels}, and 
${\rightarrow} \subseteq S\times \Lambda \times S$ is a 
ternary relation,
denoted as the set of {\em labeled transitions}. 
\end{definition}

We
 prefer to use infix notation and $(s,a ,s')\in {\rightarrow} $ will be abbreviated as
       $s  \xrightarrow{a}  s'$
to represent a transition from configuration $s$ to configuration $s'$ with label $a$. \\

\noindent
Labels can be used to represent the reading of an input, but also to represent an action performed during the transition or conditions that must hold in order to allow the use of the transition.


A {\em path} in a labeled transition system from a {\em source configuration} $s_0$
to a {\em target configuration} $s_n$ is a sequence 
$\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots \xrightarrow{a_{n-1} } s_n$. 
We define the {\em concatenation} $ \pi_1 \pi_2$ of 
two paths $\pi_1$ and $\pi_2$ when the source configuration of $\pi_2$ is equal to the target configuration of $\pi_1$
as expected.
The {\em length} of 
$\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots \xrightarrow{a_{n-1} } s_n$
is defined as $|\pi|=n$. We say the path is {\em labeled} by $a_0 a_1 , \ldots a_{n-1}$.
For all $w \in \Lambda^*$, all $s,s' \in S$, we will write $s \xrightarrow{w } s'$ if there exists a path from $s$ to $s'$ labeled by $w$. 

An {\em infinite path} is an infinite sequence
 $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots $.
For each infinite (resp. finite) path  $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots$ 
(resp. $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots \xrightarrow{a_{n-1}} s_n$)
and $i,j \in \N$ (resp. $i,j \in [0,n]$) with $i<j$ we denote
by $\pi[i,j]$ the path 
$s_i  \xrightarrow{a_i } s_{i+1}  \xrightarrow{a_{i+1} } \cdots  \xrightarrow{a_{j-1} } s_j$
 and by $\pi[i]$ the configuration $s_i$.
As expected, a {\em prefix} of a finite or infinite path $\pi$ is a finite path of the form $\pi[0,j]$, and
a  {\em suffix} of a finite path $\pi$ is a path of the form $\pi[i,n]$.  \\
Given an infinite path $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots$ let
$\text{\textit{Inf}}(\pi) = \{ s \in S \mid \forall i ~ \exists j > i ~ s_j = s\}$.

\newcommand{\pred}{\textsf{pred}}
\newcommand{\post}{\textsf{post}}
% \renewcommand{\succ}{\textsf{Succ}}


\noindent
The set of {\em successors} of a configuration $s \in S$ is deﬁned as
$\post(s) = \{ s' \in S \mid \exists a \in \Lambda ~ s \xrightarrow{a} s'\}$.
A configuration without successors is called a {\em dead end}.  \\
The set of {\em predecessor} of a configuration $s \in S$ is deﬁned as
$\pred(s) = \{ s' \in S \mid \exists a \in \Lambda ~ s' \xrightarrow{a} s\}$.



A labeled transition system $(S, \Lambda, \rightarrow)$ is {\em deterministic} if for all configurations $s_1, s_2, s_3 \in S$ and all
$a \in \Lambda$,
 $ s_1  \xrightarrow{a} s_{2}$ and  
 $s_1  \xrightarrow{a} s_{3} $ implies $s_2 = s_3 $. \\



\begin{definition}
An {\em (unlabeled) transition system} is a pair $T = (S,\rightarrow )$ where $S$ is a set of 
{\em states} and  
$ {\rightarrow} \subseteq S \times S$ is a
binary relation 
on
the set of states, denoted as the set of {\em transitions}. 
\end{definition}

We again prefer to use infix notation and write $s \rightarrow s'$ to denote a {\em transition} from state $s$ to state $s'$ (i.e., $ (s,s') \in  {\rightarrow} $). \newline
Note 
 that an unlabeled transition system can be seen as a labeled transition system where the set of labels consists of only one element. 
Determinism, (infinite) paths, their length, and concatenation in unlabeled transition systems are
then defined as expected.

%\textcolor{red}{Thinking about whether or not it is pertinent to have LTS and not only TS. LTS can be usefull for TA because of the use of the guards/time as labels but it may be unecessary.}

We write $\rightarrow^{k}$, $\rightarrow^{+}$, $\rightarrow^{=}$, $\rightarrow^{*}$
for the $k$-step iteration of $\rightarrow$, its transitive closure, its reflexive closure, its reflexive and transitive closure). We use similar notation for $\post$ and $\pred$...

Let $X,Y \subseteq S$ and $k \in \mathbb{N}$. We denote $X \longrightarrow^{*} Y$ (resp. $X \longrightarrow^{\leq k} Y$) if from all states $x \in X$ there exists a path (resp. of length smaller than $k$) that reaches a state $y \in Y$.

%\textcolor{red}{This makes sense for TS but not so much for LTS ...}

A transition system is {\em finitely branching} if all $\post(s)$ are finite. 
%\textcolor{blue}{We restrict our attention to finitely branching TSs.}

%\textcolor{blue}{Alain: the forward coverability algorithm for infinitely branching TSs.; the backward cov algo may work for essentially finitely branching TSs.}
%\textcolor{red}{Not sure that TS induced by TA are finitely branching. Actually I believe they are not, i.e. for instance for a TA with one clock $x$, from a state $q$ and clock $x$ set at $0$, if there is a transition e.g. $(q, x \geq 3, \emptyset, q')$ then the set of successors of 
%$(q,0)$ is $\{q'\} \times \{3, 4, 5, \ldots \}$. Need to check where finitely branching appears as an assumption/requirement.}


\subsection{Well-quasi-orderings}

A {\em quasi-ordering} (a qo) is any reflexive and transitive relation $\leq$.

We abbreviate $x \leq y \not\leq x$ by $x < y$.

% A partial ordering (a po) is an antisymmetric qo

Any qo induces an equivalence relation ($x \equiv y$ iff $x \leq y \leq x$).
% and gives rise to a po between the equivalence classes ?
% 	do we need po ?

We now recall a few results from the theory of well-orderings (add reference [...]).


\begin{definition}
 A {\em well-quasi-ordering} (a wqo) is any quasi-ordering $\leq$ (over some set $X$ ) such that, for any infinite sequence $x_0, x_1, x_2, ...$ in $X$, there exist indexes $i \leq j$ with
$x_i \leq  x_j$.
\end{definition}

Notice that a wqo is well-founded, i.e. it admits no infinite strictly decreasing sequence
$x_0 > x_1 > x_2 > \cdots$

% \textcolor{red}{Add lemma about infinite increasing subsequences ?}

\begin{lemma}
(Erd\"os and Rado). Assume $\leq$ is a wqo. Then any infinite sequence contains an infinite increasing subsequence: $x_{i_0} \leq x_{i_1} \leq x_{i_2} \cdots$ (with $i_0 < i_1 < i_2 \cdots$).
\end{lemma}

\iffalse
\begin{proof}
Consider an infinite sequence and the set $M = \{i \in N \mid \forall j > i ~ x_i \not\leq x_j \}$. $M$ cannot
be infinite, otherwise it would lead to an infinite subsequence contradicting the wqo
hypothesis. Thus, $M$ is bounded and any $x_i$ with $i$ beyond $M$ can start an infinite
increasing subsequence.
\end{proof}
\fi


Given $\leq$ a quasi-ordering over some set $X$, an {\em upward-closed set} is any set $I \subseteq X$ such that if $y \geq x$ and $x \in I$ then $y \in I $.
A {\em downward-closed set} is any set $I \subseteq X$ such that if $y \leq x$ and $x \in I$ then $y \in I $. 
To any $A \subseteq X$ we associate
the {\em upward-closure of $A$} 
 $\uparrow A = \{x \in X \mid \exists a \in A ~ y \geq a\}$
 and the 
 {\em downward-closure of $A$} 
 $\downarrow A = \{x \in X \mid \exists a \in A ~ y \leq a\}$. 
We abbreviate $\uparrow \{x\}$ (resp. $\downarrow \{x\}$)
as $\uparrow x$ (resp. $\downarrow x$).


A {\em basis} of an upward-closed set $I$ is a set $I_b$ such that $I = \bigcup_{x \in I_b} \uparrow x$. 
% Higman investigated ordered sets with the finite basis property.


\begin{lemma}{(Higman [40])} 
If $\leq$ is a wqo then any upward-closed $I$ has a
finite basis.
\end{lemma}

% \textcolor{red}{Expliquer ce que c'est une base d'abords.}

\begin{proof}
The set of minimal elements of $I$ is a basis because $\leq$ is well-founded. It
only contains a finite number of non-equivalent elements otherwise they would make
an infinite sequence contradicting the wqo assumption.
\end{proof}



\begin{lemma}  \label{upward-closed stablizes}
If $\leq$ is a wqo then any infinite increasing sequence $I_0 \subseteq I_1 \subseteq I_2 \subseteq \cdots$ of
upward-closed sets eventually stabilizes, i.e. there is a $k \in N$ such that 
$I_k = I_{k+1} = I_{k+2} = \cdots $.
\end{lemma}

\begin{proof}
Assue we have a counter-example.
We extract an infinite subsequence where
inclusion is strict: $I_{n_0} \subsetneq I_{n_1} \subsetneq I_{n_2} \cdots$. Now, for any $i>0$, we can pick some $x_i \in I_{n_i} \setminus I_{n_{i-1}}$. The well-quasi-ordering hypothesis means that the infinite sequence of $x_i$'s
contains an increasing pair $x_i \leq x_j$ for some $i<j$. Because $x_i$ belongs to an upward-
closed set $I_{n_i}$ we have $x_j \in I_{n_i} $, contradicting $x_j \not\in I_{n_{ j - 1}}$.
\end{proof}


% \textcolor{red}{Define WSTS}

% \textcolor{red}{Define SWSTS -  necessary}

\subsection{Well-structured transition systems}


\begin{definition}\cite{DBLP:journals/iandc/Finkel90,DBLP:journals/tcs/FinkelS01}
A {\em (resp. strongly) well-structured transition system} (abbreviated as WSTS)  $(S, \rightarrow, \leq)$
is a transition system $(S, \rightarrow)$
equipped with a wqo ${\leq} \subseteq S \times S$ between states such that  
%  decidable ≤  wqo on S, i.e., for each two given states s, s ′ ∈ S, it is decidable whether s ≤ s ′ . 
the transition relation $ \rightarrow$ is compatible (resp. strongly compatible) with the wqo, i.e., for all 
$s_1, t_1 , s_2 \in S$
	with $s_1 \leq s_2$  and $s_1 \rightarrow t_1$ , there exists 
	$t_2 \in S$ with 
	$t_1 \leq t_2$ and $s_2 \rightarrow^{*} t_2$ 			
				(resp. $s_2 \rightarrow t_2$ ).
\end{definition}

Several families of formal models of processes give rise to WSTSs in a natural way, e.g. Petri nets when inclusion between markings is used as the well-ordering.


% \textcolor{red}{Define 'has effective pred-basis'. Maybe it should be included in WSTS definition, maybe it can be another def. I kind of like the idea of 'effective pred-basis' and 'decidable $\leq$' being independant from the WSTS definition}
\iffalse
\begin{proposition}\cite{DBLP:journals/tcs/FinkelS01}
If $\mathscr{S}$ is an WSTS and $U \subseteq S$ is an upward-closed set of states, then $\pred^*(U )$ is upward-
closed.
\end{proposition}
%
Proof. Assume $s \in \pred^* (U )$. Then $s \rightarrow^* t$ for some $t \in U $. If now $s' \geq s$ then upward-compatibility entails that $s' \rightarrow^* t'$ for some $t' \geq t$. Then $t' \in U$ and $s' \in \pred^*(U )$.
\fi

\begin{proposition}\cite{DBLP:journals/tcs/FinkelS01}
If $\mathscr{S}$ is a WSTS with strong compatibility and $U \subseteq S$ is upward-closed, then $\pred(U )$, $\pred^k(U )$ and $\pred^*(U )$ are upward-closed.
\end{proposition}
%\alain{étrange ces deux propositions, l'une suffirait}
\iffalse
Proof. Assume $s \in \pred (I )$. Then $s \rightarrow t$ for some $t \in I $. If now $s' \geq s$ then strong upward-compatibility entails that $s' \rightarrow t'$ for some $t' \geq t$. Then $t' \in I$ and $s' \in \pred(I )$.

\mathieu{On peut probablement enlever la Proposition $8$ alors. La proposition $9$ étant plus directement pertinente pour les lemmes/preuves (permet d'avoir itérativement $\pred^k(I)$ upward-closed if $I$ upward-closed - for all $k$).}
\fi


\begin{definition}\cite{DBLP:journals/tcs/FinkelS01,DBLP:journals/iandc/AbdullaCJT00}
A WSTS $\mathscr{S}$ has {\em effective pred-basis} if there exists an algorithm accepting
any state $s \in S$ and returning $pb(s)$, a finite basis of $\uparrow \pred(\uparrow s)$.
\end{definition}

% \textcolor{red}{Define what an Ideal is. Actually an Ideal is just an upward-closed set, so maybe this just adds some confusion. Anti-ideal just downward closed so again just not that helpful a notation. Maybe have a }


\iffalse
\begin{definition}
A {\em bi-ideal} $I \subseteq S$ is an upward-closed and downward-closed set, i.e
$\uparrow I = I = \downarrow I$.
\end{definition}

"Bi-ideals often represent “control states” as in [cf \%]. "
% Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,

% \textcolor{red}{Probably one can already 'deduce' from this that ideal $I$ and anti-ideal $J$ for resp. good and bad states, in the case of e.g. timed automata would be given by sets of states}
\fi

A downard-closed set $J$ is {\em decidable} if, given $s \in S$, it is decidable whether
$s \in J$. 
%\textcolor{red}{Since a downward-closed set does not have an ``upward-basis'' in general, we will demand that membership is decidable.}
% \textcolor{red}{Do we still demand this ?}
%\mathieu{On peut enlever ce point de discussion ici et en discuter de manière plus complête au moment où on discute de SAFE et BAD plus en détail je pense.}

\begin{claim}{(stability of upward-closed sets)}
Let $U, V \subseteq S$ be upward-closed. Then the sets $U \cup V$, and $U \cap V$ are upward-closed.
\end{claim}


% \begin{claim}
% Given a finite set $A \subseteq S$ with $I =\uparrow A$, we can compute a finite basis $B$ of $I$.
% \end{claim}

\begin{fact}\label{fact basis}
% Fact 3 ([1]). 
% Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,
For every upward-closed set $U \subseteq S$, there exists a finite basis $B$ of $U$. 
% (ii) Given a finite set $A \subseteq S$ with $I =\uparrow A$, we can compute a finite basis $B$ of $I$.
% \alain{(ii) est bizarre car A est déjà une base finie de $\uparrow A$, et $min(A)$ est la base minimale}
\end{fact}


\begin{definition}{ (index)}. 
If $\mathscr{S}$ is a WSTS with strong compatibility and $U \subseteq S$  is upward-closed and $k \geq 0$, let $U^k= \bigcup_{0 \leq j \leq k} \pred^j(U)$.
The {\em index} $k(U)$ is the
smallest $k_0$ s.t. $U^k = U^{k_0}$ for all $k \geq k_0$.
\end{definition}


If $\mathscr{S}$ is a WSTS with strong compatibility and $I \subseteq S$ is an upward-closed set, the sets $\pred(I )$, and $\pred^{\geq k}(I )$ for
every $k \geq 0$ are upward-closed, thus Lemma~\ref{upward-closed stablizes} ensures the existence of $k(I)$.

\begin{remark}
$I^{k+1} $ can be rewritten $I^{k+1}= \bigcup_{0 \leq j \leq k+1} \pred^j(I) = 
I \cup \bigcup_{1 \leq j \leq k+1} \pred^j(I) =
I \cup \pred(\bigcup_{0 \leq j \leq k} \pred^j(I))
=  I \cup \pred(I^k)$.
\end{remark}

This ensures the following.

\begin{fact}\label{stop condition}
% Fact 4 (stop condition). 
If $\mathscr{S}$ is a WSTS with strong monotony and $I \subseteq S$ is an upward-closed set and $k \geq 0$ s.t. $I^k = I^{k+1}$ , then $I^\ell = I^k$ for all $\ell \geq k$, i.e.,
$k(I) \leq k$. This also implies that $\pred^*(I) = I^k$.
\end{fact}

\iffalse
\begin{remark}
$I^{k+1} = \bigcup_{0 \leq j \leq k+1} \pred^j(I) = 
I \cup \bigcup_{1 \leq j \leq k+1} \pred^j(I) =
I \cup \pred(\bigcup_{0 \leq j \leq k} \pred^j(I))
=  I \cup \pred(I^k)$.
\end{remark}
\fi

\begin{lemma}
% Lemma 3 ([1]) 
% Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,
 Given a basis of an upward-closed set $I \subseteq S$, and a state $s$ of an effective strongly well-structured transition
system, we can decide whether we can reach $I$ from $s$.
\end{lemma}

\begin{proof}
We have to show that we can compute a basis of $I^{k+1}$ if we are given a basis of $I^k $. 
Then the
decidability of the stop condition follows directly. Let $B$ be a basis of $I^k$. 
We have
$$I^{k+1} = I \cup \pred(I^k ) = I \cup
\bigcup_{s' \in B}
\pred(\uparrow \{s' \}).$$

Since $\pred(\uparrow \{s' \}$) is computable for any $s'\in S$ by definition, we obtain a finite generating set of $I^{k+1}$ . By
Fact~\ref{fact basis}, we can compute a basis of $I^{k+1}$.
\end{proof}

\begin{theorem}
A finite basis of $ \pred^*(U)$ is computable for any WSTS $\mathscr{S}$ and any upward closed set $U \subseteq S$.
\end{theorem}

