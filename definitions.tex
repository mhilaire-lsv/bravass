
\section{Definitions}\label{section definitions}



In this section, we introduce general notations and preliminary definitions.

The model we are interested in is (S)WSTS (and later some particular instances, i.e. Timed/Counter Automata for instance).


% \textcolor{red}{Before defining WSTS, need a definition of TS and WQO}


\subsection{Transition systems}


\begin{definition}
A {\em labeled transition system} (LTS for short) is a tuple $\mathscr{S}=(S, \Lambda, \rightarrow)$ where 
$S$ is a set of {\em states}, $ \Lambda$ is a set of {\em labels}, and 
${\rightarrow} \subseteq S\times \Lambda \times S$ is a 
ternary relation,
denoted as the set of {\em labeled transitions}. 
\end{definition}

We
 prefer to use infix notation and $(s,a ,s')\in {\rightarrow} $ will be abbreviated as
       $s  \xrightarrow{a}  s'$
to represent a transition from configuration $s$ to configuration $s'$ with label $a$. \\

\noindent
Labels can be used to represent the reading of an input, but also to represent an action performed during the transition or conditions that must hold in order to allow the use of the transition.


A {\em path} in a labeled transition system from a {\em source configuration} $s_0$
to a {\em target configuration} $s_n$ is a sequence 
$\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots \xrightarrow{a_{n-1} } s_n$. 
We define the {\em concatenation} $ \pi_1 \pi_2$ of 
two paths $\pi_1$ and $\pi_2$ when the source configuration of $\pi_2$ is equal to the target configuration of $\pi_1$
as expected.
The {\em length} of 
$\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots \xrightarrow{a_{n-1} } s_n$
is defined as $|\pi|=n$. We say the path is {\em labeled} by $a_0 a_1 , \ldots a_{n-1}$.
For all $w \in \Lambda^*$, all $s,s' \in S$, we will write $s \xrightarrow{w } s'$ if there exists a path from $s$ to $s'$ labeled by $w$. 

An {\em infinite path} is an infinite sequence
 $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots $.
For each infinite (resp. finite) path  $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots$ 
(resp. $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots \xrightarrow{a_{n-1}} s_n$)
and $i,j \in \N$ (resp. $i,j \in [0,n]$) with $i<j$ we denote
by $\pi[i,j]$ the path 
$s_i  \xrightarrow{a_i } s_{i+1}  \xrightarrow{a_{i+1} } \cdots  \xrightarrow{a_{j-1} } s_j$
 and by $\pi[i]$ the configuration $s_i$.
As expected, a {\em prefix} of a finite or infinite path $\pi$ is a finite path of the form $\pi[0,j]$, and
a  {\em suffix} of a finite path $\pi$ is a path of the form $\pi[i,n]$.  \\
Given an infinite path $\pi = s_0 \xrightarrow{a_0 } s_1 \xrightarrow{a_1 } \cdots$ let
$\text{\textit{Inf}}(\pi) = \{ s \in S \mid \forall i ~ \exists j > i ~ s_j = s\}$.

\newcommand{\pred}{\textsf{pred}}
\newcommand{\post}{\textsf{post}}
% \renewcommand{\succ}{\textsf{Succ}}


\noindent
The set of {\em successors} of a configuration $s \in S$ is deﬁned as
$\post(s) = \{ s' \in S \mid \exists a \in \Lambda ~ s \xrightarrow{a} s'\}$.
A configuration without successors is called a {\em dead end}.  \\
The set of {\em predecessor} of a configuration $s \in S$ is deﬁned as
$\pred(s) = \{ s' \in S \mid \exists a \in \Lambda ~ s' \xrightarrow{a} s\}$.



A labeled transition system $(S, \Lambda, \rightarrow)$ is {\em deterministic} if for all configurations $s_1, s_2, s_3 \in S$ and all
$a \in \Lambda$,
 $ s_1  \xrightarrow{a} s_{2}$ and  
 $s_1  \xrightarrow{a} s_{3} $ implies $s_2 = s_3 $. \\



\begin{definition}
An {\em (unlabeled) transition system} is a pair $T = (S,\rightarrow )$ where $S$ is a set of 
{\em states} and  
$ {\rightarrow} \subseteq S \times S$ is a
binary relation 
on
the set of states, denoted as the set of {\em transitions}. 
\end{definition}

We again prefer to use infix notation and write $s \rightarrow s'$ to denote a {\em transition} from state $s$ to state $s'$ (i.e., $ (s,s') \in  {\rightarrow} $). \newline
Note 
 that an unlabeled transition system can be seen as a labeled transition system where the set of labels consists of only one element. 
Determinism, (infinite) paths, their length, and concatenation in unlabeled transition systems are
then defined as expected.

%\textcolor{red}{Thinking about whether or not it is pertinent to have LTS and not only TS. LTS can be usefull for TA because of the use of the guards/time as labels but it may be unecessary.}

We write $\rightarrow^{k}$, $\rightarrow^{+}$, $\rightarrow^{=}$, $\rightarrow^{*}$
for the $k$-step iteration of $\rightarrow$, its transitive closure, its reflexive closure, its reflexive and transitive closure). We use similar notation for $\post$ and $\pred$...

Let $X,Y \subseteq S$ and $k \in \mathbb{N}$. We denote $X \longrightarrow^{*} Y$ (resp. $X \longrightarrow^{\leq k} Y$) if from all states $x \in X$ there exists a path (resp. of length smaller than $k$) that reaches a state $y \in Y$.

%\textcolor{red}{This makes sense for TS but not so much for LTS ...}

A transition system is {\em finitely branching} if all $\post(s)$ are finite. 
%\textcolor{blue}{We restrict our attention to finitely branching TSs.}

%\textcolor{blue}{Alain: the forward coverability algorithm for infinitely branching TSs.; the backward cov algo may work for essentially finitely branching TSs.}
%\textcolor{red}{Not sure that TS induced by TA are finitely branching. Actually I believe they are not, i.e. for instance for a TA with one clock $x$, from a state $q$ and clock $x$ set at $0$, if there is a transition e.g. $(q, x \geq 3, \emptyset, q')$ then the set of successors of 
%$(q,0)$ is $\{q'\} \times \{3, 4, 5, \ldots \}$. Need to check where finitely branching appears as an assumption/requirement.}


\subsection{Well-quasi-orderings}

A {\em quasi-ordering} (a qo) is any reflexive and transitive relation $\leq$.

We abbreviate $x \leq y \not\leq x$ by $x < y$.

% A partial ordering (a po) is an antisymmetric qo

Any qo induces an equivalence relation ($x \equiv y$ iff $x \leq y \leq x$).
% and gives rise to a po between the equivalence classes ?
% 	do we need po ?

We now recall a few results from the theory of well-orderings (add reference [...]).


\begin{definition}
 A {\em well-quasi-ordering} (a wqo) is any quasi-ordering $\leq$ (over some set $X$ ) such that, for any infinite sequence $x_0, x_1, x_2, ...$ in $X$, there exist indexes $i \leq j$ with
$x_i \leq  x_j$.
\end{definition}

Notice that a wqo is well-founded, i.e. it admits no infinite strictly decreasing sequence
$x_0 > x_1 > x_2 > \cdots$

% \textcolor{red}{Add lemma about infinite increasing subsequences ?}

\begin{lemma}
(Erd\"os and Rado). Assume $\leq$ is a wqo. Then any infinite sequence contains an infinite increasing subsequence: $x_{i_0} \leq x_{i_1} \leq x_{i_2} \cdots$ (with $i_0 < i_1 < i_2 \cdots$).
\end{lemma}

\iffalse
\begin{proof}
Consider an infinite sequence and the set $M = \{i \in N \mid \forall j > i ~ x_i \not\leq x_j \}$. $M$ cannot
be infinite, otherwise it would lead to an infinite subsequence contradicting the wqo
hypothesis. Thus, $M$ is bounded and any $x_i$ with $i$ beyond $M$ can start an infinite
increasing subsequence.
\end{proof}
\fi


Given $\leq$ a quasi-ordering over some set $X$, an {\em upward-closed set} is any set $I \subseteq X$ such that if $y \geq x$ and $x \in I$ then $y \in I $.
A {\em downward-closed set} is any set $I \subseteq X$ such that if $y \leq x$ and $x \in I$ then $y \in I $. 
To any $A \subseteq X$ we associate
the {\em upward-closure of $A$} 
 $\uparrow A = \{x \in X \mid \exists a \in A ~ y \geq a\}$
 and the 
 {\em downward-closure of $A$} 
 $\downarrow A = \{x \in X \mid \exists a \in A ~ y \leq a\}$. 
We abbreviate $\uparrow \{x\}$ (resp. $\downarrow \{x\}$)
as $\uparrow x$ (resp. $\downarrow x$).


A {\em basis} of an upward-closed set $I$ is a set $I_b$ such that $I = \bigcup_{x \in I_b} \uparrow x$. 
% Higman investigated ordered sets with the finite basis property.


\begin{lemma}{(Higman [40])} 
If $\leq$ is a wqo then any upward-closed $I$ has a
finite basis.
\end{lemma}

% \textcolor{red}{Expliquer ce que c'est une base d'abords.}

\begin{proof}
The set of minimal elements of $I$ is a basis because $\leq$ is well-founded. It
only contains a finite number of non-equivalent elements otherwise they would make
an infinite sequence contradicting the wqo assumption.
\end{proof}



\begin{lemma}  \label{upward-closed stablizes}
If $\leq$ is a wqo then any infinite increasing sequence $I_0 \subseteq I_1 \subseteq I_2 \subseteq \cdots$ of
upward-closed sets eventually stabilizes, i.e. there is a $k \in N$ such that 
$I_k = I_{k+1} = I_{k+2} = \cdots $.
\end{lemma}

\begin{proof}
Assue we have a counter-example.
We extract an infinite subsequence where
inclusion is strict: $I_{n_0} \subsetneq I_{n_1} \subsetneq I_{n_2} \cdots$. Now, for any $i>0$, we can pick some $x_i \in I_{n_i} \setminus I_{n_{i-1}}$. The well-quasi-ordering hypothesis means that the infinite sequence of $x_i$'s
contains an increasing pair $x_i \leq x_j$ for some $i<j$. Because $x_i$ belongs to an upward-
closed set $I_{n_i}$ we have $x_j \in I_{n_i} $, contradicting $x_j \not\in I_{n_{ j - 1}}$.
\end{proof}


% \textcolor{red}{Define WSTS}

% \textcolor{red}{Define SWSTS -  necessary}

\subsection{Well-structured transition systems}


\begin{definition}\cite{DBLP:journals/iandc/Finkel90,DBLP:journals/tcs/FinkelS01}
A {\em (resp. strongly) well-structured transition system} (abbreviated as WSTS)  $(S, \rightarrow, \leq)$
is a transition system $(S, \rightarrow)$
equipped with a wqo ${\leq} \subseteq S \times S$ between states such that  
%  decidable ≤  wqo on S, i.e., for each two given states s, s ′ ∈ S, it is decidable whether s ≤ s ′ . 
the transition relation $ \rightarrow$ is compatible (resp. strongly compatible) with the wqo, i.e., for all 
$s_1, t_1 , s_2 \in S$
	with $s_1 \leq s_2$  and $s_1 \rightarrow t_1$ , there exists 
	$t_2 \in S$ with 
	$t_1 \leq t_2$ and $s_2 \rightarrow^{*} t_2$ 			
				(resp. $s_2 \rightarrow t_2$ ).
\end{definition}

Several families of formal models of processes give rise to WSTSs in a natural way, e.g. Petri nets when inclusion between markings is used as the well-ordering.


% \textcolor{red}{Define 'has effective pred-basis'. Maybe it should be included in WSTS definition, maybe it can be another def. I kind of like the idea of 'effective pred-basis' and 'decidable $\leq$' being independant from the WSTS definition}
\iffalse
\begin{proposition}\cite{DBLP:journals/tcs/FinkelS01}
If $\mathscr{S}$ is an WSTS and $U \subseteq S$ is an upward-closed set of states, then $\pred^*(U )$ is upward-
closed.
\end{proposition}
%
Proof. Assume $s \in \pred^* (U )$. Then $s \rightarrow^* t$ for some $t \in U $. If now $s' \geq s$ then upward-compatibility entails that $s' \rightarrow^* t'$ for some $t' \geq t$. Then $t' \in U$ and $s' \in \pred^*(U )$.
\fi

\begin{proposition}\cite{DBLP:journals/tcs/FinkelS01}
If $\mathscr{S}$ is a WSTS with strong compatibility and $U \subseteq S$ is upward-closed, then $\pred(U )$, $\pred^k(U )$ and $\pred^*(U )$ are upward-closed.
\end{proposition}
%\alain{étrange ces deux propositions, l'une suffirait}
\iffalse
Proof. Assume $s \in \pred (I )$. Then $s \rightarrow t$ for some $t \in I $. If now $s' \geq s$ then strong upward-compatibility entails that $s' \rightarrow t'$ for some $t' \geq t$. Then $t' \in I$ and $s' \in \pred(I )$.

\mathieu{On peut probablement enlever la Proposition $8$ alors. La proposition $9$ étant plus directement pertinente pour les lemmes/preuves (permet d'avoir itérativement $\pred^k(I)$ upward-closed if $I$ upward-closed - for all $k$).}
\fi


\begin{definition}\cite{DBLP:journals/tcs/FinkelS01,DBLP:journals/iandc/AbdullaCJT00}
A WSTS $\mathscr{S}$ has {\em effective pred-basis} if there exists an algorithm accepting
any state $s \in S$ and returning $pb(s)$, a finite basis of $\uparrow \pred(\uparrow s)$.
\end{definition}

% \textcolor{red}{Define what an Ideal is. Actually an Ideal is just an upward-closed set, so maybe this just adds some confusion. Anti-ideal just downward closed so again just not that helpful a notation. Maybe have a }


\iffalse
\begin{definition}
A {\em bi-ideal} $I \subseteq S$ is an upward-closed and downward-closed set, i.e
$\uparrow I = I = \downarrow I$.
\end{definition}

"Bi-ideals often represent “control states” as in [cf \%]. "
% Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,

% \textcolor{red}{Probably one can already 'deduce' from this that ideal $I$ and anti-ideal $J$ for resp. good and bad states, in the case of e.g. timed automata would be given by sets of states}
\fi

A downard-closed set $J$ is {\em decidable} if, given $s \in S$, it is decidable whether
$s \in J$. 
%\textcolor{red}{Since a downward-closed set does not have an ``upward-basis'' in general, we will demand that membership is decidable.}
% \textcolor{red}{Do we still demand this ?}
%\mathieu{On peut enlever ce point de discussion ici et en discuter de manière plus complête au moment où on discute de SAFE et BAD plus en détail je pense.}

\begin{claim}{(stability of upward-closed sets)}
Let $U, V \subseteq S$ be upward-closed. Then the sets $U \cup V$, and $U \cap V$ are upward-closed.
\end{claim}


% \begin{claim}
% Given a finite set $A \subseteq S$ with $I =\uparrow A$, we can compute a finite basis $B$ of $I$.
% \end{claim}

\begin{fact}\label{fact basis}
% Fact 3 ([1]). 
% Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,
For every upward-closed set $U \subseteq S$, there exists a finite basis $B$ of $U$. 
% (ii) Given a finite set $A \subseteq S$ with $I =\uparrow A$, we can compute a finite basis $B$ of $I$.
% \alain{(ii) est bizarre car A est déjà une base finie de $\uparrow A$, et $min(A)$ est la base minimale}
\end{fact}


\begin{definition}{ (index)}. 
If $\mathscr{S}$ is a WSTS with strong compatibility and $U \subseteq S$  is upward-closed and $k \geq 0$, let $U^k= \bigcup_{0 \leq j \leq k} \pred^j(U)$.
The {\em index} $k(U)$ is the
smallest $k_0$ s.t. $U^k = U^{k_0}$ for all $k \geq k_0$.
\end{definition}


If $\mathscr{S}$ is a WSTS with strong compatibility and $I \subseteq S$ is an upward-closed set, the sets $\pred(I )$, and $\pred^{\geq k}(I )$ for
every $k \geq 0$ are upward-closed, thus Lemma~\ref{upward-closed stablizes} ensures the existence of $k(I)$.

\begin{remark}
$I^{k+1} $ can be rewritten $I^{k+1}= \bigcup_{0 \leq j \leq k+1} \pred^j(I) = 
I \cup \bigcup_{1 \leq j \leq k+1} \pred^j(I) =
I \cup \pred(\bigcup_{0 \leq j \leq k} \pred^j(I))
=  I \cup \pred(I^k)$.
\end{remark}

This ensures the following.

\begin{fact}\label{stop condition}
% Fact 4 (stop condition). 
If $\mathscr{S}$ is a WSTS with strong monotony and $I \subseteq S$ is an upward-closed set and $k \geq 0$ s.t. $I^k = I^{k+1}$ , then $I^\ell = I^k$ for all $\ell \geq k$, i.e.,
$k(I) \leq k$. This also implies that $\pred^*(I) = I^k$.
\end{fact}

\iffalse
\begin{remark}
$I^{k+1} = \bigcup_{0 \leq j \leq k+1} \pred^j(I) = 
I \cup \bigcup_{1 \leq j \leq k+1} \pred^j(I) =
I \cup \pred(\bigcup_{0 \leq j \leq k} \pred^j(I))
=  I \cup \pred(I^k)$.
\end{remark}
\fi

\begin{lemma}
% Lemma 3 ([1]) 
% Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,
 Given a basis of an upward-closed set $I \subseteq S$, and a state $s$ of an effective strongly well-structured transition
system, we can decide whether we can reach $I$ from $s$.
\end{lemma}

\begin{proof}
We have to show that we can compute a basis of $I^{k+1}$ if we are given a basis of $I^k $. 
Then the
decidability of the stop condition follows directly. Let $B$ be a basis of $I^k$. 
We have
$$I^{k+1} = I \cup \pred(I^k ) = I \cup
\bigcup_{s' \in B}
\pred(\uparrow \{s' \}).$$

Since $\pred(\uparrow \{s' \}$) is computable for any $s'\in S$ by definition, we obtain a finite generating set of $I^{k+1}$ . By
Fact~\ref{fact basis}, we can compute a basis of $I^{k+1}$.
\end{proof}

\begin{theorem}
A finite basis of $ \pred^*(U)$ is computable for any WSTS $\mathscr{S}$ and any upward closed set $U \subseteq S$.
\end{theorem}

%%%
\iffalse
%%%%
%%%%
\subsection{Defining resilience}


\subsubsection{Resilience for general transition systems}

% \textcolor{red}{Ask the question why use a set of propositions for $SAFE$ and $BAD$ rather than use subsets of the set of configurations ? }

We ask whether we can reach a state 
%which satisfies
in 
%
$SAFE$  in a reasonable amount of time whenever we reach a state 
% which satisfies
in
%
$BAD$. 
From this we formulate two resilience problems. First consider the case where the recovery time
is bound by a given natural number $k \geq 0$, i.e., the \emph{explicit resilience problem} for TS.

\problemx{$k$-Resilience problem }
{a transition system $(S,\rightarrow)$, an integer $k$, a state $s \in S$, $SAFE, BAD \subseteq S$ and $SAFE \cap BAD = \emptyset$.}
{$\forall s' \in BAD, ~ s \rightarrow^* s' \implies \exists s'' \in SAFE ~ s' \rightarrow^{\leq k} s''$ ?\newline}

If a system $S$ satisfies the explicit resilience property for an integer $k$, we say that $S$ is $k$-resilient.

% If we assume that the transition system yields infinite sequences of transitions, we can express the property to be evaluated in CTL by s |= AG(BAD → 0≤ j≤k EX j SAFE). 

We can also ask whether there exists such a bound $k$ such that $S$ is $k$-resilient. We call this problem the \emph{bounded resilience problem}.

%
%\problemx{Bounded Resilience problem}
%{a transition system $(S,\rightarrow)$, a state $s \in S$, $Safe, BAD \subseteq S$ and $Safe \cap BAD = \emptyset$.}
%{$\exists k \geq 0 ~ \forall s' \in BAD, ~ s \rightarrow^* s' \implies \exists s'' \in Safe ~ s' \rightarrow^{\leq k} s''$ ?\newline}
%


\problemx{Bounded Resilience problem}
{a transition system $(S,\rightarrow)$, a state $s \in S$, $Safe, Bad \subseteq S$ and $Safe \cap Bad = \emptyset$.}
{$\exists k \geq 0  \mathscr{S}$ is $k$-resilient. ?\newline}
%%
\fi
%%%


pour $k,k'$ donnés, chercher si $Safe_{max}$ et $Bad_{max}$ ont un sens ? on peut faire l'union des Safe, Safe' et des Bad, Bad' prendre le max des k. Fixer k, chercher et calculer $Safe_{max}$ et $Bad_{max}$.

%
%\alain{dire juste que Safe = upward closed et BAD = downward closed.
%envisager les 3 autres cas. souvent BAD = upward closed (par ex l'exclusion mutuelle).
%4 resilience problem (U,D), (U,U), (D,U), (D,D)}

\section{Uniform resilience for WSTS}


The resilience problem (resp. the $k$-resilience problem) in a transition system is to decide whether from a bad state, there exists a path (resp. a path of length smaller than $k$) that reaches a Safe state. Let us formalize these properties.

\problemx{uniform resilience problem (URP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and two sets $Safe, Bad \subseteq S$.}
{$Bad \longrightarrow^{*} Safe$ ?\newline}
%
%\alain{il faudrait ne pas répéter 3 fois les mêmes imputs pour les 3 pbs: énoncer les 3 uniformes pbs d'un coup avec une fois l'input puis les 3 pbs pour un état s donné sans répéter non plus 3 fois les mêmes inputs}

\problemx{uniform $k$-resilience problem (UkRP)}
{A transition system $\mathscr{S}=(S,\rightarrow), k \in \mathbb{N}$ and two sets $Safe, Bad \subseteq S$.}
{$Bad \longrightarrow^{\leq k} Safe$ ?\newline}

We add a third problem that decides whether there exists an $k$ such  that the system is $k$-resilient.
%
\problemx{uniform bounded resilience problem (UBRP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and two sets $Safe, Bad \subseteq S$.}
%{$\exists k \geq 0 ~ \forall s' \in D ~ s \rightarrow^* s' \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\newline}
{$\exists k \geq 0$ such that $\mathscr{S}$ is uniformely $k$-resilient ?\newline}

\alain{trouver les Bad et Safe maximum tels que S est resilient. est-ce vrai que si S est $(B_i,D_i)$-resilient alors S est $(\cap, \cup B_i,D_i)$-resilient ? on pourrait décider que Safe=complement de Bad et donc on aurait un seul ensemble (et son complement)}

These three reachability problems are decidable for finite transition systems but undecidable for (general) infinite-state transition systems. 
So we restrict our framework to the class of infinite-state WSTS. Since most of decidable properties in WSTS are given as effective upward or downward closed sets \cite{DBLP:journals/iandc/AbdullaCJT00, DBLP:journals/tcs/FinkelS01}, we consider upward closed or downward closed sets Safe and Bad.
\alain{on peut penser à des ensembles Bad definis dans une logique booleennne sur les clos par le bas, haut, +...}

For instance, the well-known mutual exclusion property is often modelized in a $d$-counters machine by the property that a counter $c_{mutex}$ must be bounded by (usually) one. Then, the set $Safe =  \{c_{mutex} \leq 1\} \times \mathbb{N}^{d-1}$ is downward closed and $Bad =\{c_{mutex} \geq 2\} \times  \mathbb{N}^{d-1} $ is the upward closed complementary of Safe. In \cite{DBLP:conf/gg/Ozkan22}, the authors considered that Bad is always downward closed and Safe is always upward closed.
%		
URP is decidable for lossy counter machines (LCM) with Safe and Bad semilinear sets as a consequence of results in Section 3.4 of \cite{DBLP:conf/rp/Schnoebelen10}. In particular, the existing proofs of resilience use the decidability of reachability; but we wish to decide resilience for models with undecidable reachability.
%
In what follows, we will always suppose that a downward closed set $D$ is given by its finite set of ideals $I_D=\{J_1, J_2,...,J_n\}$ satisfying $D=\downarrow D = \downarrow (J_1 \cup J_2 \cup..\cup J_n)$ and that an upward closed set $U$ is given by its finite set $Min_U$ of its minimal elements satisfying $U=\uparrow Min_U$.

Let $U,V$ be two upward-closed sets given by its set of minimal element and $D,E$ be two downward-closed sets given by its ideal decomposition. All the four  inclusions $U \subseteq V$,  $U \subseteq D$, $D \subseteq U$ and $D \subseteq E$ are decidable provided that the ordering is decidable and sets are recursive.
%
\alain{on peut penser à des ensembles bad definis dans une logique booleennne sur les clos par le bas, haut, +...}


\begin{proposition}\label{general}
$\mathscr{S}=(S,\rightarrow,\leq)$ is uniformely (bad,Safe)-resilient iff $bad \subseteq \pred^*(Safe)$.\\
$\mathscr{S}=(S,\rightarrow,\leq)$ is uniformely (bad,Safe)-bounded-resilient iff $\mathscr{S}=(S,\rightarrow,\leq)$ is uniformely (bad,Safe)-resilient.\\
$\mathscr{S}=(S,\rightarrow,\leq)$ is uniformely (bad,Safe)-$k$-resilient iff $bad \subseteq \pred^k(Safe)$.
\end{proposition}

\begin{proof}
Resilient means that 
\end{proof}


\subsection{Case: $Safe=\uparrow Safe$.}


\begin{theorem}\label{up-down}
The three uniform resilience problems are decidable for WSTS with effective predbasis and $Safe=\uparrow Safe$.
%	and bad is upward closed or downward closed.
\end{theorem}


\begin{proof}
Let us first solve if $\mathscr{S}=(S,\rightarrow,\leq)$ is uniformely (bad,Safe)-resilient. Since $Safe=\uparrow Safe$, and WSTS, $\pred^*(Safe)=\uparrow \pred^*(Safe)$, so $\pred^*(Safe)$ admits a finite basis $B_{\pred^*(Safe)}$. since WSTS  with effective predbasis, we may compute a finite basis of $\pred^*(Safe)$ with the backward coverability algorithm. 
%Then if bad is upward closed or downward closed, we may decide the inclusion $Bad \subseteq \uparrow B_{\pred^*(Safe)}$ which remais to compare, in both cases, two finite sets. 
if bad  is upward closed, $bad = \uparrow B_{bad}$ and $ \uparrow B_{bad} \subseteq \uparrow B_{\pred^*(Safe)}$ iff for every $b \in B_{bad}$, there is a $s \in B_{\pred^*(Safe)}$ such that $s \leq b$. similar reasonning for the other case.
hence the two uniform resilience problems are decidable.

Let us examine the uniform $k$-resilience problem (UkRP). we may compute the least $n$ such that $bad \subseteq \uparrow \pred^n(Safe)=  \uparrow \pred^*(Safe)$. S is uniformely $k$-resilient iff $n \leq k$ \alain{hum...mais il peut y avoir des chemins plus courts}and then UkRP is decidable.
\end{proof}

%One begins to test whether $Bad \cap \pred^*(Safe) = \emptyset$ then never resilient car une fois dans bad j'y reste sans pouvoir aller dans Safe.\\

If $Bad \cap \pred^*(Safe) \neq \emptyset$, One computes the minimal elements $A$ of $Bad \cap \pred^*(Safe)$.
resilient iff $Bad \subseteq \pred^*(Safe)$  (eq $Bad \cap \pred^*(Safe) = Bad$)

$Bad \cap \pred^*(Safe) \neq Bad$ alors, on peut se limiter à $Bad' = Bad \cap \pred^*(Safe)$ et c'est (Bad',Safe)-resilient.

Let us show that the predbasis hypothesis can be replaced by other hypotheses.

\subsection{Case: $Safe=\uparrow Safe$ and $BAD=\downarrow BAD$.}

%
%		cas étudié par les deux articles sur les graphes
%


%  Parosh Aziz Abdulla, Karlis Cerans, Bengt Jonsson & Yih-Kuen Tsay (1996): General Decidability Theorems for Infinite-State Systems. In: Proc. LICS 1996, IEEE Computer Society Press, pp. 313–321,
%  Alain Finkel & Philippe Schnoebelen (2001): Well-structured transition systems everywhere! Theor. Comput. Sci. 256(1-2), pp. 63–92, doi:10.1016/S0304-3975(00)00102-X.

%Transfering the abstract resilience problems into this framework,
%it is therefore reasonable to demand that both propositions, Safe and BAD, are given by 
%upward-closed or downward-closed sets.

The \emph{completion}  \cite{BFM-ic17} of a WSTS $\mathscr{S}=(S,\rightarrow, \leq)$ is the associated ordered transition system $\hat{\mathscr{S}}=(Ideals(S),\rightarrow, \subseteq)$ where states of $\hat{\mathscr{S}}$ are ideals of $S$ and $I \rightarrow J$ if $J$ belongs to the finite ideal decomposition of $\downarrow \post_{\mathscr{S}}(I)$. The completion is always finitely branching but it is not necessarly WSTS since $\subseteq$ is not necessarly a wqo. $\hat{\mathscr{S}}$ is WSTS iff $\mathscr{S}=(S,\rightarrow, \leq)$ is $\omega^2$-WSTS (intuitively speaking, $(S,\leq)$ must not contain the Rado set). Coverability is shown decidable  [Theorem 44] in \cite{BFM-ic17} for completion-post-effective $\omega^2$-WSTS.

Let us recall two other results in \cite{BFM-ic17}. Proposition 30 establishes a strong relation between the runs of a WSTS $\mathscr{S}=(S,\rightarrow, \leq)$ and the runs of its completion $\hat{\mathscr{S}}$. It states that if $x \xrightarrow{k} y$ in $\mathscr{S}$ then for every ideal $I \supseteq \downarrow x$, there exists an ideal $J \supseteq \downarrow y$ such that $I \xrightarrow{k} J$ in $\hat{\mathscr{S}}$. Proposition 29 establishes that if $I \xrightarrow{k} J$ in $\hat{\mathscr{S}}$ then for every $y \in J$, there exists $x \in I$ and $y' \geq y$ such that $x \xrightarrow{k'} y'$ in $\mathscr{S}$. Moreover, if $\mathscr{S}$ has transitive compatibility then $k’ \geq k$; if $\mathscr{S}$ has strong compatibility then $k’ = k$.


\begin{proposition}\label{down-up}
Let $\mathscr{S}=(S,\rightarrow, \leq)$ be a completion-post-effective $\omega^2$-WSTS with strong compatibility and two finite sets: $I_{BAD}$ and $Min_{Safe}$.
The uniform resilience problem (URP) and the uniform bounded resilience problem (UBRP) are decidable.
The uniform $k$-resilience problem (UkRP) is decidable if moreover $\mathscr{S}$ has the predbasis hypothesis.
\end{proposition}

\begin{proof}
Let $I_{BAD}=\{J_1, J_2,...,J_n\}$ be the ideal decomposition of $BAD$ and $B_{Safe}=\{b_1,b_2,...,b_m\}$ be the minimal basis of $Safe$.
The uniform resilience problem (URP) is equivalent to an infinite number of instances of the coverability problem : for all $x \in BAD$ does there exist an $j$ such that $b_j$ is coverable from $x$. This infinite set of coverability questions can be reduced to $n$ instances of the coverability problem in the completion $\hat{\mathscr{S}}=(Ideals(S),\rightarrow, \subseteq)$ of $\mathscr{S}=(S,\rightarrow, \leq)$.

%Proposition 30 in \cite{BFM-icalp14} establishes a strong relation between the runs of a WSTS $\mathscr{S}=(S,\rightarrow, \leq)$ and the runs of its completion $\hat{\mathscr{S}}$. It states that if $x \xrightarrow{k} y$ in $\mathscr{S}$ then for every ideal $I \supseteq \downarrow x$, there exists an ideal $J \supseteq \downarrow y$ such that $I \xrightarrow{k} J$ in $\hat{\mathscr{S}}$. Proposition 29 establishes that if $I \xrightarrow{k} J$ in $\hat{\mathscr{S}}$ then for every $y \in J$, there exists $x \in I$ and $y' \geq y$ such that $x \xrightarrow{*} y'$ in $\mathscr{S}$.

Let us show that $b_j$ is coverable from $x$ in $\mathscr{S}$ iff $\downarrow b_j$ is coverable (for inclusion) from $\downarrow x$ in $\hat{\mathscr{S}}$.

Suppose that $b_j$ is coverable from $x$ then there exists a run $x \xrightarrow{k} y \geq b_j$. From Proposition 30, there exist an ideal $J$ and a run $\downarrow x \xrightarrow{k} J$ where $J \supseteq \downarrow y \supseteq \downarrow b_j$ in $\hat{\mathscr{S}}$, hence $b_j$ is covered from $\downarrow x$.
Conversely, if $I \xrightarrow{k} J$ in $\hat{\mathscr{S}}$ with $\downarrow b_j \subseteq J$ then 
%	for every $y \in J$, 
there exists $x \in I$ and $y' \geq b_j$ such that $x \xrightarrow{k} y'  \geq b_j$ in $\mathscr{S}$ and then $b_j$ is coverable from $x$ in $\mathscr{S}$.

%
% iff there is a run in $\hat{S}$ from an ideal I to J such that  $\downarrow x \subseteq I$ and $\downarrow b_j \subseteq J$. This is a consequence of  
%Propositions 29 and 30 in \cite{BFM-icalp14} that establish a strong relation between the runs of a WSTS $\mathscr{S}=(S,\rightarrow, \leq)$ with its completion $\hat{S}$.
%' \in I(BAD)$.

To decide the (uniform) bounded resilience problem (UBRP), we decide $n \times m$ coverability questions: is state $b_j$ coverable from ideal $J_i$ ? If all these $n \times m$ coverability questions are positive then we compute $K=max(k_a \mid a=1,..,m \times n)$ and we deduce that  $\mathscr{S}$ is uniformely $K$-resilient. Since coverability is decidable for completion-post-effective $\omega^2$-WSTS, we have shown that both the uniform resilience problem (UBRP) and the uniform bounded resilience problem (UBRP) are decidable.

To decide the UkRP, we may compare the input $k$ with $K$. If $k \geq K$, we conclude that is uniformely $k$-resilient; if $k < K$ we cannot answer. if moreover $\mathscr{S}=(S,\rightarrow, \leq)$ has the predbasis hypothesis, we may compute the least $n$ such that $ \uparrow \pred^n(Safe)=  \uparrow \pred^*(Safe)$. S is uniformely $k$-resilient iff $n \leq k$ \alain{hum...mais il peut y avoir des chemins plus courts}and then UkRP is decidable.
\end{proof}

%

\subsection{Case: $Safe=\uparrow Safe$ and $BAD=\uparrow BAD$.}

%%



\subsection{Case: $Safe=\downarrow Safe$ and $BAD=\downarrow BAD$.}

%%%%%%%%
\subsection{Case: $Safe=\downarrow Safe$ and $BAD=\uparrow BAD$.}
%
%		cas exclusion mutuelle
%
je prends les minimaux de bad et les idéaux de Safe, pas sur que ce soit decidable....$pred(Safe)$


\begin{tabular}{ l c r }
   BAD/Safe & Up & Down \\
   Up & dec ? & dec ? \\
   Down & dec & ? \\
 \end{tabular}

%We first assume that the safety property is given by an upward-closed set and the bad condition by a decidable downward-closed set. 
% \textcolor{red}{Seems like a reasonable assumption to me.}

%From these considerations, we formulate instances of the abstract resilience problems for well-
%structured transition systems.


\section{Resilience for WSTS}


Uniform resilience is a strong property since it implies that from bad there must exist a path to Safe. But, when one considers a system with an initial state $s_0$, it could be sufficient to ask that only from $post^*(s_0) \cap Bad$, there must exist a path to Safe. However, this condition seems more difficult since one also must decide whether a state $s \in Bad$ is reachable from $s_0$.
%
%\problemx{(I,J)-$k$-resilience problem for WSTS}
%{A state $s$ of a WSTS $(S,\rightarrow, \leq)$, an effective set $I$ (with a given basis), a set $J$.}
%{$\forall s' \in J ~ (s \rightarrow^* s') \implies \exists s'' \in I ~ s' \rightarrow^{\leq k} s''$ ?\newline}
%
%\problemx{general $k$-resilience problem for WSTS}
%{A state $s$ of a WSTS $(S,\rightarrow, \leq)$, an effective set $I$ (with a given basis).}
%{$\forall s'  ~ (s \rightarrow^* s') \implies \exists s'' \in I ~ s' \rightarrow^{\leq k} s''$ ?\newline}

Again, we first consider the case where the recovery time is bounded by a $k \in \N$.

\problemx{$k$-resilience problem for WSTS}
{A state $s$ of a WSTS $(S,\rightarrow, \leq)$, an upward-closed set $U$ with a given basis, a decidable downward-closed set $D$.}
{$D \longrightarrow^{\leq k} U$ ?  ou $D \cap post^*(s) \longrightarrow^{\leq k} U$ ?  \newline}
%
%  		{$\forall s' ~ (s \rightarrow^* s') \wedge s' \in D  \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\newline}
%
$D \longrightarrow^{\leq k} U$: $\forall s' \in D \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\\
%
$D \cap post^*(s) \longrightarrow^{\leq k} U$ ?
%
$\forall s' ~ (s \rightarrow^* s') \wedge s' \in D  \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?
 \alain{ça signifie pour tout $d \in D$ il existe un chemin de longueur $\leq k$ qui arrive dans un $u \in U$. c'est plus simple et plus général et ça ne demande moins de décider l'accessibilité....comment faire pour vérifier pour tous les (D,U) ? sinon ça dépend tjs de l'état intial $s$ et s'il faut vérifier pour tous les $s$....}


%ou plus simple : $D \rightarrow^{\leq k} U$ ? 


%Analogously, we formulate the resilience problem for WSTSs.

\problemx{bounded Resilience problem for WSTS}
{A state $s$ of a WSTS $W=(S,\rightarrow, \leq)$, an upward-closed set $U$ with a given basis, a decidable downward-closed set $D$.}
%{$\exists k \geq 0 ~ \forall s' \in D ~ s \rightarrow^* s' \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\newline}
{$\exists k \geq 0$ such that $W$ is $k$-resilient. ?\newline}

\problemx{Resilience problem for WSTS}
{A state $s$ of a WSTS $(S,\rightarrow, \leq)$, an upward-closed set $U$ with a given basis, a decidable downward-closed set $D$.}
{$ ~ \forall s' \in D ~ (s \rightarrow^* s') \implies \exists s'' \in U ~ s' \rightarrow^{*} s''$ ?\newline}

%\textcolor{blue}{
%justification des definitions: si on enlève la condition  an upward-closed set $U$ (extended resilience $U$ qq) reachability reduces to resilience (avec $U=\{x\}$ donc indecidable pour les modèles à reachability indécidable.
%}

\begin{remark} 
We require $U$ to be upward-closed, as, in the general case if we lift restrictions on $U$ and $D$, then reachability reduces itself to resilience. Indeed, the particular resilience problem where we take $D = \{s\}$ and $U = \{x\}$ is reachability of $x$ from $s$, and thus generally undecidable for WSTS. 
\end{remark}

\textcolor{blue}{
et encore: renforcer sur l'hypothèses sur I, J tous les deux clos par le haut+bas.
}

\textcolor{blue}{
compute the sets of $(I,J,k)$ st S is resilient.\\
max des I,J possibles \\
}






\begin{proposition}\label{reductions}
coverability and $t$-liveness are reduceable to resilience.
%	home state and reachability
\end{proposition}


\begin{proof}

\begin{itemize}
\item Let us choose $J=S= \downarrow S$ and $I=\uparrow x$ then resilience is equivalent to coverability of $x$ from $s$.
%\item $J=\{s\}$ and $I=\{x\}$ this particular resilience is reachability of $x$ from $s$.

\item $t$-liveness  can be expressed as the following formula
$ ~ \forall s' \in S ~ (s \rightarrow^* s') \implies \exists s'' \in U_t ~ s' \rightarrow^{*} s''$ 
where
$U_t=\uparrow \pred(t)$
is the upward closure of the preconditions to use transition $t$.  
The problem reduces itself to the resilience problem
where $J=S$ and $I = \uparrow \pred(t)$.

%\item the home state problem can be expressed as $\ldots$
\end{itemize}

%	\mathieu{Ne marche pas (un des deux sens est invalide imho)}
%  \textcolor{red}{  Let $J=\downarrow S = S$ and $I = \uparrow t$ where $t \in S$. Now resilience remains to the following property: $\forall s' \in S,  \exists s'' \in I, ~ s' \rightarrow^{*} s''$. Let us apply this property to LCS with $I = \uparrow (q,\epsilon) = (q, \Sigma^*)$. This property, $\forall s' \in S,  \exists w \in \Sigma^* $ such that $ ~ s' \rightarrow^{*} (q,w)$ expresses that there is an infinite run passing infinitely often through the control-state $q$; this LTL-property has been proved undecidable for Lossy Channel Systems (LCS) \cite{DBLP:conf/icalp/AbdullaJ94}.
% Since LCS are effective WSTS with strong monotony (with an adequate semantics), we conclude.}
%	\mathieu{Ne marche pas (un des deux sens est invalide imho)}
\end{proof}




% Since Reset Petri nets are also effective WSTS with strong monotony, we could think to use the undecidability of LTL for Reset Petri nets.

% and with effective basis of $post^*$ ???

% expliquer toutes les variantes de la résilience

% Let $(X,\leq)$ be a wqo and $U$ be an upward closed subset of $X$. We say that $U$ is \emph{computable} if there is an algorithm that computes a finite basis of $U$.


\begin{theorem}\cite{DBLP:conf/gg/Ozkan22,DBLP:journals/corr/abs-2108-00889}
{\sc bounded resilience} is decidable for WSTS $S$ with strong upward compatibility and such that $\uparrow post^*(S)$ is computable.
\end{theorem}

We may immediately generalyse this last result by strenghthenin to \emph{unbounded} resilience. The proof is essentially the same than the previous one.

\begin{corollary}\label{postcomputable}
{\sc resilience} is decidable for WSTS with strong upward compatibility and such that $\uparrow post^*(S)$ is computable.
\end{corollary}


\begin{proof}
From Fact~\ref{stop condition}, there exists $k \in \N$ such that
$\post^*(I) = I^{k_m}$. We can compute this $k_m$ by iteratively computing
$I^{k+1}$ from $I^k$, checking $I^{k+1}=I^k$, 
returning $k_m$ if that is the case.
Then, because $k_m$-resilience is decidable, 
checking $\uparrow post^*(s) \cap J \subseteq I^k = \pred^*(I)$ is,
and resilience is decidable.
% \textcolor{red}{à faire Mathieu}
\end{proof}

%\"Ozkan
\begin{proposition}[Proposition 1 in \cite{DBLP:conf/gg/Ozkan22}]
For finite-branching WSTS with strong upward compatibility, a basis of $\uparrow \post^*(s)$ is computable for every given state $s$ iff the downward-closed problem is decidable, i.e. given a state $s$ of a WSTS
% in the regarded class 
with strong upward compatibility 
and a decidable downward-closed set $J$, it can be decided whether $\exists s' \in J ~ s \to^* s'$. 
\end{proposition}

The characterization is used to show that Petri nets are $\post^*$-effective. It is well-known that Petri nets constitute WSTS with strong upward compatibility (Thm.~6.1 in \cite{DBLP:journals/tcs/FinkelS01}). Hence Resilience is decidable for Petri nets and VASS.
However, the hypothesis that $\uparrow \post^*$ is computable cannot be tested in the general WSTS framework.

\begin{proposition}
There exist classes of WSTSs with strong upward compatibility for which there don't exist an algorithm computing a basis of $\uparrow \post^*$.
\end{proposition}


\begin{proof}
Let us show that Reset VASS don't enjoy the property that $\uparrow \post^*$ is computable.
Suppose that one are able to compute a finite basis of $\uparrow post^*$ for Reset VASS. Then, one would be able to decide whether $0$ is reachable 
%in counter $i$ 
by examining if there is %some vector $v$ in the basis such that $v(i)=0$
$0$ in the basis%
. But reachability of $0$  %in a counter $i$ 
is undecidable for Reset VASS. 
% sont WSTS with strong compatibility. et l'accessibilité est undecidable.
%	$\uparrow post^*$ n'est pas calculable pour les LCS non plus car $\uparrow post^*= \uparrow \downarrow post^*$ n'est pas calculable ???
\end{proof}

%il existe des modèles où on peut calculer $\uparrow post^*$: inserted channel systems: on sait calculer $post^*$ qui est rationnel donc on sait calculer $\uparrow post^*$.

remarque si on enlève la strong monotony mais en gardant with effective basis of $\uparrow post^*$:


\begin{proposition}(à prouver)
 leur algorithme for {\sc bounded resilience} termine mais pas correct for WSTS with upward compatibility, not necessarly strong, and an effective basis of $\uparrow post^*$ ?
\end{proposition}

\begin{proof}
leur algorithme termine mais pas correct car l'intersection de post et J car alors le lemmme xxxx est faux (contre-exemple)
 \textcolor{red}{à faire Mathieu}
 
\mathieu{En train de chercher un contre exemple pour le corollaire du Lemme~\ref{Lemma intersection}.} 
 
\mathieu{

On considère un LCS, où on autorise à effacer des messages (lossyness) mais effacer un message prends une étape (contrairement à [ref], où ils font une sorte de cloture de effacer-transition-effacer). On n'a alors pas la strong compatibility: 

On prends: $(q, b) 	\to (q,bb)$ par exemple et $(q, baaaaaa) \geq (q,b) $, alors
$(s, baaaaaa) \to^* (s,b) \to (s,bb)$
MAIS

C'est pas "en une étape".

(On considère -il faut le mentionner/vérifier- que on ne peut effaçer que d'un coté ? et pas au milieu?)

Dans ce cas là, du coup, $pred(\uparrow \{(q,b)\}$ n'est pas clos par le haut. \\

Revenons au Corollaire

On voudrais avoir

$post^* (s) \cap J \subseteq I^k$

MAIS pas

$ (\uparrow post^* (s)) \cap J \subseteq I^k$ \\


Ça serait un cas où leurs algorithme vas dire 
"On n'a pas $(\uparrow post^* (s)) \cap J \subseteq I^k$ donc on n'a pas la $k$-résilience "

Alors qu'on aurait la $k$-résilience (i.e. $post^* (s) \cap J \subseteq I^k$)

Pour $I^k$, le contre exemple prendrait du coup $pred(\uparrow \{ (q,b)\})$ qui n'est pas clos par le haut.

On voudrait

$post^*(s) \cap J \subseteq pred(\uparrow \{ (q,b)\})$


Je propose de prendre $J$ = ensemble des configurations je pense le truc ici doit venir de
$\uparrow post^* (s)$ being too big
donc autant pas se restreindre du tout sur $J$


$post^*(s) \subseteq pred(\uparrow \{ (q,b)\})$

Si $s=(q,b)$ par exemple, et que on peut aller de $q$ vers $q$ en écrivant un 
$b$ ? et évidement en perdant le dernier message (parce qu'on est lossy). Et c'est tout, disons.

Déjà par lossiness $(q,\epsilon)$ serait dans $post^*((q,b))$.

Et aussi dans $pred(\uparrow \{ (q,b)\})$ puisque $(q,\epsilon) \to (q,b)$.

Donc on aurait:

$post^*((q,b))  \subseteq pred(\uparrow \{ (q,b)\})$

Et on aurait $(q,aaaaaa)$ dans 
$\uparrow post^* ((q,b))$ puisque $(q,\epsilon)$ est dans $post^* ((q,b))$.

Hors $(q,aaaaa)$ est pas dans $pred(\uparrow \{ (q,b)\})$
(même si il est dans $pred^*(\uparrow \{ (q,b)\})$).



}
 
 
 
 
\end{proof}

\begin{proposition}(à prouver)
{\sc bounded resilience} is undecidable for WSTS with upward compatibility withd an effective basis of $post^*$.
\end{proposition}

\begin{proof}
 \textcolor{red}{pas certain ! à faire Mathieu}
\end{proof}

%
%si on garde strong mais on enlève effective basis of $post^*$:
%
%\begin{proposition}(à prouver)
%{\sc $k$-resilience}, hence {\sc bounded resilience}, is undecidable for effective WSTS with strong upward compatibility.
%\end{proposition}
%
%\begin{proof}
%pas de effective basis of $post^*$. leur algorithme n'est plus un algo. ex reset PN ?  \textcolor{red}{pas certain ! à faire Mathieu}
%\end{proof}



Unfortunately, resilience is undecidable for (general) WSTS even with strong monotony.
This stems from the fact that $t$-liveness is undecidable for reset Petri-Nets.


\begin{theorem}[Adjusting Theorem~5.5 from \cite{peterson1981petri}]
The  Reset Petri Net zero reachability problem can be reduced to the liveness problem.
\end{theorem}

\begin{proof}
If we wish to determine if $0 \in R(C_1, \mu_1)$ in any
reset Petri net $C_1 = (P_1, T_1, I_1, O_1, R_1 )$ (where $R_1(t) =$ places that are reset when t fires off), with initial marking $\mu_1$, we construct a
reset petri net $C_2 = (P_2, T_2, I_2, O_2, R_2 )$ with initial marking
$\mu_2$ which is live if and only if the zero marking is not reachable from $\mu_1$.

The reset PN $C_2$ is constructed from $C_1$ by the addition of two places $r_1$ and $r_2$
and $|P_1| +2$ transitions $s$, $\{ s_p | p \in P_1 \}$ and $s'$.

We first modify all transitions of $T_1$ to include $r_1$ as both an input and an output.
The initial marking $\mu_2$ will include a token in $r_1$. 


The place $r_1$ is a 'run' place; as long as the token remains in $r_1$ the transitions of $T_1$ can fire normally.
Thus any marking which is reachable in the places of $P_1$ is also reachable in $C_2$.



Transition $s$ is defined to have $r_1$ as an input and a null output.
This allows the token in $r_1$ to be removed, disabling all transitions in $T_1$
and "freezing" the marking of $P_1$.

Note that all transitions of $T_1$ are in conflict and, by construction if not by definition, no more than one transition can fire at a time.

The place $r_1$ and transition $s$ allow the net $C_1$ to reach any reachable marking and then for $s$ to fire and freeze the net at that marking.

Now we need to see if that marking is zero.

We introduce a new place $r_2$ and new transitions $s_p$ which have $p$ as input and $r_2$ as output.

If $p$ can ever become zero, $s_p$ is not live. The entire net is dead if
$s$ fires in the marking zero.

If we can always have some $p_i$ not be zero, then we can always fire some $s_{p_i}$, putting a token in $r_2$.

In this case we must put a token back in $r_1$ and assure that all transitions in $C_2$ are live.
We must be sure that $C_2$ is live even if $C_1$ is {\em not} live.
This is accomplished by a transition $s'$ which  "floods" the net $C_2$ with tokens, assuring that every transition is live if a token is ever put in $r_2$.
Transition $s'$ has $r_2$ as its input and every place of $C_2$ as output

Now if $0$ is reachable
in $R(C_1, \mu_1)$ 
then the net $C_2$ can also reach this marking
in the place of $P_1$ by executing the same sequence of transition firings.
Then $s$ can fire, freezing the $C_1$ subset.
Since $mu(p_i) = 0$ for all $p_i \in P_1$, no transition $s_{p_i}$ with $p_i \in P_1$ can fire, and $C_2$ is dead.
Thus if $0$ is reachable then $C_2$ is not live.

Conversey, if $C_2$ is not live, then a marking $\mu$ must be reachable in which 
$\mu(r_2) = 0$ and there is no reachable state in which $r_2$ has a token
(in particular, since we do not allow token removal from $r_2$, the marking $\mu$ must be reached in a sequence of transitions that do not place any token in $r_2$.)
% (Rappel: tant que il y a un token quelque part, on peut mettre un token en r_2
% et r_2 commence sans token)
If $r_2$ has no token and cannot get any, then the transitions $s_p$ are not live, and the markings of $p$ for $p \in P_1$ must be zero. 
Thus if $C_2$ is not live then a marking is reachable in which the marking of each $p$ in $P_1$ is zero. 


\end{proof}

\begin{corollary}
Reset Petri Net liveness is undecidable 
\end{corollary}

\begin{corollary}
Reset Petri Net $t$-liveness is undecidable 
\end{corollary}


Since $t$-liveness is undecidable for reset Petri-Nets that are WSTS with strong monotony, from Proposition \ref{reductions},  we deduce that resilience is undecidable for WSTS with strong monotony.

\begin{theorem}
{\sc resilience} is undecidable for WSTS with strong monotony.
\end{theorem}






\begin{proposition}
In WSTS with strong monotony, the bounded resilience problem is
reducible to the $k$-resilience problem.
\end{proposition}

\begin{proof}
strong WSTS
$\pred^*(I) = \pred^{k}(I)$
Check all $k$ until $\pred^*(I) = \pred^{k}(I)$.
\end{proof}

\begin{proposition}
In WSTS with strong monotony, the bounded resilience problem is
equivalent to the resilience problem.
\end{proposition}

\begin{proof}
strong WSTS

$\pred^*(I) = \pred^{k}(I)$

\end{proof}

\begin{corollary}
Bounded Resilience is undecidable for WSTS with strong monotony.
\end{corollary}

\begin{proof} 
  From
  cf
the two  theorems above. 
\end{proof}



Let us deduce that effective basis of $post^*$ ex reset PN ?

Since VASS are WSTS with strong upward compatibility and since there is an algorithm that computes a finite basis of  $\uparrow post^*(S)$, \cite{DBLP:conf/gg/Ozkan22} deduced that bounded resilience is decidable for VASS, hence resilience is decidable for VASS. \alain{resilience decidable for LCS ? LCS sont-ils strong (quelle sémantique ?) et $\uparrow post^*(S)$ is computable ?}

We may consider context-free grammars.

\begin{corollary}
{\sc resilience} is decidable for finite automata and context-free grammars (seen as transition systems)
\end{corollary}

\begin{proof}

  \textcolor{red}{à faire Mathieu}
Context-free grammars are WSTS \cite{DBLP:journals/tcs/FinkelS01} \alain{monotony ne semble pas strong...}avec $\uparrow post^*$ calculable (because the reachability set of a pushdown machine is an effectively computable regular language) ???? resilience decidable.
\end{proof}


\cite{DBLP:journals/ipl/BouajjaniEFMRWW00}


