
\section{Resilience for WSTS}


% \alain{pourquoi redire ça, c'est dans l'intro : In this section we introduce the concepts of resilience, bounded-resilience and $k$-resilience for well structured transition systems. We show that the resilience problems are decidable for  completion-post-effective $\omega^2$-WSTS with strong compatibility with $\Safe=\uparrow \Safe$, and that resilience is decidable for downward-compatible ideal-effective WSTS when $\Safe=\downarrow \Safe$.  We show that the three resilience problems are however undecidable for WSTS with strong compatibility in general.}


In a transition system $\mathscr{S}=(S,\rightarrow)$, we consider a subset of states $\Safe \subseteq S$, and its complement, $\Bad$.
%	The property of mutual exclusion is often modelised with $\Safe = \downarrow \Safe$.
The \emph{resilience problem} (resp. the \emph{$k$-resilience problem}) for $(\mathscr{S},\Safe)$ is to decide whether from \emph{any} state in %$\Bad$
$S$, \emph{there exists} a path (resp. a path of length smaller than or equal to $k$) that reaches a state in $\Safe$. Resilience is then the Home-Space problem for the set $\Safe$. We use the notation 
% $\Bad \longrightarrow^{*} \Safe$ (resp. $\Bad \longrightarrow^{\leq k} \Safe$)
$S \longrightarrow^{*} \Safe$ (resp. $S \longrightarrow^{\leq k} \Safe$)
 for 
 %$\forall x \in \Bad, \exists y \in \Safe$ 
$\forall x \in S, \exists y \in \Safe$ 
 such that $x \longrightarrow^{*} y$ 
 %(resp.  $\forall x \in \Bad, \exists y \in \Safe$ such that $x \longrightarrow^{\leq k} y$).
  (resp.  $\forall x \in S, \exists y \in \Safe$ such that $x \longrightarrow^{\leq k} y$).
  In our framework, $\Safe \subseteq S$  is possibly infinite but  must admit a computable finite representation : for example, downward-closed sets and upward-closed sets in wqo and semilinear sets in $\mathbb{N}^d$ have finite representations. 





Let us formalize three resilience problems.


\problemx{Resilience (RP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and a set $\Safe \subseteq S$.}
{$S \longrightarrow^{*} \Safe$ ?\newline}

% \alain{il faudrait ne pas répéter 3 fois les mêmes imputs pour les 3 pbs: énoncer les 3 uniformes pbs d'un coup avec une fois l'input puis les 3 pbs pour un état s donné sans répéter non plus 3 fois les mêmes inputs}


\problemx{$k$-resilience (kRP)}
{A transition system $\mathscr{S}=(S,\rightarrow), k \in \mathbb{N}$ and a sets $\Safe \subseteq S$.}
{$S \longrightarrow^{\leq k} \Safe$ ?\newline}

\problemx{Bounded resilience (BRP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and a set $\Safe \subseteq S$.}
%{$\exists k \geq 0 ~ \forall s' \in D ~ s \rightarrow^* s' \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\newline}
{$\exists k \geq 0$ such that {$S \longrightarrow^{\leq k} \Safe$ ?\newline}}

%$\mathscr{S}$ is %uniformely
% $k$-resilient ?\newline}

  
These three resilience problems are decidable for finite transition systems but undecidable for (general) infinite-state transition systems. So we restrict our framework to the class of infinite-state WSTS. Since most of decidable properties in WSTS rely on the computation of upward or downward-closed sets \cite{DBLP:journals/iandc/AbdullaCJT00,DBLP:journals/tcs/FinkelS01}, we consider upward-closed or downward-closed sets $\Safe$% and $\Bad$
. Since $\Safe \subseteq \pred^*(\Safe)$, one only need to decide whether 
the complement of $\Safe$ is in $\pred^*(\Safe)$. From now on, we use $\Bad$ to denote the complement of $\Safe$.
In \cite{DBLP:journals/corr/abs-2108-00889}, the authors considered that $\Safe$ is upward-closed. %\mathieu{Remarquer que dans l'example~\ref{Example} on a à la fois upward closed ET downward closed pour $\Safe$ ET $\Bad$.} 
% Remark that in {\bf Flight Controller System}, $\Safe$ and $\Bad$ are both upward-closed \emph{and} downward-closed.

%Surprinsingly, we have not found decidability results about the resilience problems for WSTS.	
%% We deduce decidability results for the four pairs of sets $\Safe$ and $\Bad$ downward-closed and upward-closed as seen in Section~\ref{synthesis}.
%In particular, the existing proofs of resilience use the decidability of reachability;
%\mathieu{quelles preuves ? pour quelle notion de résilience ?} but we wish to decide resilience for models with undecidable reachability.
%Our result will rely on coverability instead of reachability. We moreover show undecidability when coverability is not decidable in the case $\Safe = \uparrow \Safe$
%and in the general case when $\Safe = \downarrow \Safe$.
 



{\bf Related problems.} 
Resilience and the home-space problem are also linked to the 
model-checking of basic reachability and safety formulae. 
In particular~\cite{DBLP:conf/rp/Schnoebelen10} shows that the ``from-all'' formula $\forall s \in X~ \exists t \in Y~ s \to^* t$
% which has been shown
is decidable for Lossy Counter Machine (LCM)
when $X$ and $Y$ are semi-linear sets.
Other decidable formulae include ``one-to-one'' ($\exists s \in  X ~ \exists t \in  Y ~ s \to^* 
 t$), and ``all-to-same'' ($\exists t \in  Y ~ \forall s \in  X ~ s \to^*  t$),
whereas ``one-to-all'' ($\exists s \in  X ~ \forall t \in  Y ~ s \to^*  t$), 
``all-to-all'' ($\forall s \in  X ~ \forall t \in  Y ~ s \to^*  t$)
  and ``to-all'' ($\forall t \in  Y  ~ \exists s \in  X ~ s \to^*  t$) are undecidable (again, for LCM). 
  
  
  
\input{resilience-safe-up}

\input{resilience-safe-down}


{\bf Synthesis of the main decidability results}\label{synthesis}
\begin{center}
\begin{tabular}{ | l | c | c | c | r |}
\hline   \ %& $\uparrow$~ $\uparrow$~ 
		& $\Safe = {\uparrow \Safe}$~ 
		 & $\Safe = {\downarrow \Safe}$~ 
		 %& $\downarrow$~ $\downarrow$~
 \\ \hline
   RP %& Decidable (Thm~\ref{up-up}) 
   	& Decidable (Thm~\ref{down-up})  
   		 & Decidable (Thm~\ref{up-down}) 
   	%	 & Undecidable (Thm~\ref{down-down})
    \\ \hline
   BRP %& Decidable (Corollary~\ref{B-up-up}) 
   &  Decidable (Thm~\ref{down-up}) 
   		 & ?
   	%	 & ??
    \\ \hline
      kRP %& Decidable (Thm~\ref{k-up-up}) 
      & Decidable (Thm~\ref{down-up}) 
      		& ? 
      	%	& ??
       \\ \hline
 \end{tabular}
\end{center}

%%%%%%%
\iffalse
%%%%%%%%%%%%
\subsection{Computing the maximal resilient subsystem}

We now briefly investigate the question to control a system such that its controlled behavior may always reach $\Safe$.
%
Let $\mathscr{S}=(S, \rightarrow, \leq)$ be WSTS and $\Safe \subseteq S$ be an upward-closed set given by its finite minimal basis $B_{\Safe}$. 
%
%		\begin{definition}
We say that $\mathscr{S}=(S, \rightarrow, \leq)$ is $\Safe$-resilient if $S  \xrightarrow{*} \Safe$ is satisfied.  
%		\end{definition}
%
We may verify that  $\mathscr{S}=(S, \rightarrow, \leq)$ is $\Safe$-resilient iff  $\mathscr{S}=(S, \rightarrow, \leq)$ is $\pred^*(\Safe)$-resilient. 

The \emph{maximal $\Safe$-resilient subsystem} of $\mathscr{S}=(S,\rightarrow,\leq)$ is defined as $\mathscr{S}_{\Safe}=(S,\rightarrow_{\Safe},\leq)$ where $\rightarrow_{\Safe}$ is the largest restriction of $\rightarrow$ that insures that $\mathscr{S}_{\Safe}$ is $\Safe$-resilient.
%\alain{vérifier que la plus grande existe}
Let us remark that given a WSTS $\mathscr{S}=(S, \rightarrow, \leq)$, one may construct many \emph{guard} systems where every transition $s \rightarrow s'$ of $\mathscr{S}$ is guarded by a (monotone) formula $\phi$ defined by the grammar $\phi ::= s \geq u \mid s' \geq u \mid \phi \vee \phi \mid \phi \wedge \phi$ where $u \in S$. Since guards restrict the original runs but don't create new ones, every guarded transition system $\mathscr{S'}$ is a subsystem of $\mathscr{S}$. Since these formula are upward-compatible, the guarded transition systems $\mathscr{S'}=(S, \rightarrow', \leq)$ are still WSTS.
%
For example, VASS and most of concrete WSTS allow such guards.
  %	\lor s' \geq x_2  	\lor...	\lor s' \geq x_p$ (facile dans les VASS et modèles habituels).

\begin{theorem}{}
Given an effective WSTS with effective pred-basis and an upward-closed set $\Safe$, the maximal resilient subsystem is a computable WSTS.
\end{theorem}

\begin{proof}
Since $\Safe \subseteq S$ is upward-closed and $\mathscr{S}=(S, \rightarrow, \leq)$ is an effective WSTS with effective pred-basis, we compute the minimal basis of $\pred^*(\Safe)=\{x_1,x_2,...,x_p\}$. 
%
%
Then we add the following guard $s' \geq x_1  	\vee s' \geq x_2  	\vee...	\vee s' \geq x_p$ to every transition $s \rightarrow s'$ of $\mathscr{S}$ and we define  $s \rightarrow' s'$ as $(s' \geq x_1  	\vee s' \geq x_2  	\vee...	\vee s' \geq x_p) \wedge s \rightarrow s'$ ; this insures that the new (guarded) WSTS $\mathscr{S'}=(S, \rightarrow', \leq,s_0)$ is $\pred^*(\Safe)$-resilient and then it is also the maximal resilient sub-WSTS of $\mathscr{S}=(S, \rightarrow, \leq)$.
		\end{proof}
%
%It is also possible to define $(s_0,Safe)$-resilient systems as satisfying $\post^*(s_0) \xrightarrow{*} Safe$.

%%%%%%%
\fi
%%%%%%%%%


