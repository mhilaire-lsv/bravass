
\section{Resilience for WSTS}


In a transition system $\mathscr{S}=(S,\rightarrow)$, we consider two subsets of states $\Safe, \Bad \subseteq S$ such that $\Safe \cap  \Bad = \emptyset$ and $\Safe ,  \Bad \neq \emptyset$.
%	The property of mutual exclusion is often modelised with $\Safe = \downarrow \Safe$.
The \emph{resilience problem} (resp. the \emph{$k$-resilience problem}) for $(\mathscr{S},\Safe,\Bad)$ is to decide whether from \emph{any} state in $\Bad$, \emph{there exists} a path (resp. a path of length smaller than or equal to $k$) that reaches a state in $\Safe$. We use the notation $\Bad \longrightarrow^{*} \Safe$ (resp. $\Bad \longrightarrow^{\leq k} \Safe$) for $\forall x \in \Bad, \exists y \in \Safe$ such that $x \longrightarrow^{*} y$ (resp.  $\forall x \in \Bad, \exists y \in \Safe$ such that $x \longrightarrow^{\leq k} y$). In our framework, $\Safe, \Bad \subseteq S$  are possibly infinite but they must admit a computable finite representation : for example, downward-closed sets and upward-closed sets in wqo and semilinear sets in $\mathbb{N}^d$ have finite representations. 
%	If $\Safe = S \backslash \Bad$, then $\Safe$ is downward-closed iff $\Bad$ is upward-closed. 
Let us formalize three resilience problems.

\alain{faire le lien avec home space, et les formules dans Schnoebelen}

\problemx{resilience problem (RP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and two sets $\Safe, \Bad \subseteq S$.}
{$\Bad \longrightarrow^{*} \Safe$ ?\newline}
%
%\alain{il faudrait ne pas répéter 3 fois les mêmes imputs pour les 3 pbs: énoncer les 3 uniformes pbs d'un coup avec une fois l'input puis les 3 pbs pour un état s donné sans répéter non plus 3 fois les mêmes inputs}

%We add a third problem that decides whether there exists an $k$ such  that the system is $k$-resilient.
%

\problemx{$k$-resilience problem (kRP)}
{A transition system $\mathscr{S}=(S,\rightarrow), k \in \mathbb{N}$ and two sets $\Safe, \Bad \subseteq S$.}
{$\Bad \longrightarrow^{\leq k} \Safe$ ?\newline}

\problemx{bounded resilience problem (BRP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and two sets $\Safe, \Bad \subseteq S$.}
%{$\exists k \geq 0 ~ \forall s' \in D ~ s \rightarrow^* s' \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\newline}
{$\exists k \geq 0$ such that $\mathscr{S}$ is %uniformely
 $k$-resilient ?\newline}


\begin{example}
Let us consider a $\mathds{Z}$-VASS with only one state $q$, one counter, and one transition that adds $+1$ to the counter, with $\Safe = \uparrow q(0)$, $\Bad = \downarrow q(-1)$,
then resilience hold (one always ends up in the positive integers) but not bounded resilience: for every bound $k$ there is an element of $\Bad$ e.g. $q(-k-1)$ which necessitate at least $k+1$ steps before it can reach $\Safe$. 
\end{example}


\begin{remark}[Reformulation]\label{reformulation}
$\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Safe, \Bad)-resilient iff $\Bad \subseteq \pred^*(\Safe)$.\\
$\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Safe, \Bad)-$k$-resilient iff $\Bad \subseteq \pred^{\leq k}(\Safe)$.
\end{remark}

These three resilience problems are decidable for finite transition systems but undecidable for (general) infinite-state transition systems. So we restrict our framework to the class of infinite-state WSTS. Since most of decidable properties in WSTS rely on the computation of upward or downward-closed sets \cite{DBLP:journals/iandc/AbdullaCJT00, DBLP:journals/tcs/FinkelS01}, we consider upward-closed or downward-closed sets $\Safe$ and $\Bad$. In \cite{DBLP:journals/corr/abs-2108-00889}, the authors considered that $\Bad$ is downward-closed and $\Safe$ is upward-closed.

Surprinsingly, we have not found decidability results about the resilience problems for WSTS.

%		
We \alain{deduce} 
% \textcolor{red}{that the three resilience problems are decidable for all four pairs of sets $\Safe$ and $\Bad$ downward-closed and upward-closed sets.}
% \mathieu{changer ça}
decidability results for the four pairs of sets $\Safe$ and $\Bad$ downward-closed and upward-closed as seen in Section~\ref{synthesis}.

In particular, the existing proofs of resilience use the decidability of reachability; but we wish to decide resilience for models with undecidable reachability.
%
\alain{il manque un résultat d'indecidabilité pour les 3 resilience pour les WSTS+...}
%	 and ideals are recursive 





\iffalse

\begin{proposition}\label{general}
\textcolor{red}{
$\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Bad,\Safe)-bounded-resilient iff $\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Bad,\Safe)-resilient (CONJECTURE FOR NOW)
}
\end{proposition}

\begin{proof}
Resilient means that ...
\end{proof}

\fi






% \mathieu{En fait de plus en plus j'ai l'impression que on peut se passer des neutres: même dans une situation où on aurait des configurations neutre j'aurais tendance à dire qu'on peut se ramener à un cas safe complémentaire de bad en duplicants les neutres en deux parties, une avec "on a vu un very bad récement il faut aller vers safe" (et qui dans le nouveau modèle seraient donc bad) et une "on a pas vu de very bad tout vas bien" (et qui dans le nouveau modèle seraient donc safe)
% $=>$ Rédiger ça plus proprement}
While considering a sequence of configurations, every prefix is always 
either in the case that the latest visited $\Bad$ configuration has already been followed by a $\Safe$ configuration
or in the case that it still has to. 
Thus, in context, there are no true ``neutral'' configurations: either a neutral configuration is contextually ``$\Safe$'' because it follows a visit in a $\Safe$ configuration, either it is contextually ``$\Bad$'' because it follows a visit in a $\Bad$ configuration and has, accordingly, to reach a $\Safe$ one.
Hence we will consider not only $\Bad$ and $\Safe$ disjoint but
% w.l.o.g.
	also
$\Bad$ complement of $\Safe$,
in which case
if $\Bad$ is downward-closed then $\Safe$ is upward-closed and vice-versa.
Cases where $\Bad$ or $\Safe$ are not complements of each other, and share closure properties, i.e. are both downward-closed or both upward-closed,
have also been studied, 
see 
Appendix~\ref{case down down}
and
Appendix~\ref{case up up} for results.



\input{resilience-safe-up}

\input{resilience-safe-down}


{\bf Synthesis of the main results}\label{synthesis}

% \mathieu{En rouge quand il s'agit de conjectures}


% \alain{simplifier le tableau en enlevant les deux dernières colonnes}

\begin{center}
\begin{tabular}{ | l | c | c | c | r |}
\hline   \Safe~\Bad %& $\uparrow$~ $\uparrow$~ 
		& $\uparrow$~ $\downarrow$~ 
		 & $\downarrow$~ $\uparrow$~ 
		 %& $\downarrow$~ $\downarrow$~
 \\ \hline
   RP %& Decidable (Thm~\ref{up-up}) 
   	& Decidable (Thm~\ref{down-up})  
   		 & Decidable (Thm~\ref{up-down}) 
   	%	 & Undecidable (Thm~\ref{down-down})
    \\ \hline
   BRP %& Decidable (Corollary~\ref{B-up-up}) 
   &  Decidable (Thm~\ref{down-up}) 
   		 & ?? 
   	%	 & ??
    \\ \hline
      kRP %& Decidable (Thm~\ref{k-up-up}) 
      & Decidable (Thm~\ref{down-up}) 
      		& ?? 
      	%	& ??
       \\ \hline
 \end{tabular}
\end{center}




%We first assume that the safety property is given by an upward-closed set and the bad condition by a decidable downward-closed set. 
% \textcolor{red}{Seems like a reasonable assumption to me.}

%From these considerations, we formulate instances of the abstract resilience problems for well-
%structured transition systems.


