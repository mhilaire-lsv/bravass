
\section{Resilience for WSTS}

In a transition system $\mathscr{S}=(S,\rightarrow)$, we consider two subsets of states $\Safe, \Bad \subseteq S$ such that $\Safe \cap  \Bad = \emptyset$ and $\Safe ,  \Bad \neq \emptyset$.
%	The property of mutual exclusion is often modelised with $\Safe = \downarrow \Safe$.
The \emph{resilience problem} (resp. the \emph{$k$-resilience problem}) for $(\mathscr{S},\Safe,\Bad)$ is to decide whether from \emph{any} state in $\Bad$, \emph{there exists} a path (resp. a path of length smaller than or equal to $k$) that reaches a state in $\Safe$. We use the notation $\Bad \longrightarrow^{*} \Safe$ (resp. $\Bad \longrightarrow^{\leq k} \Safe$) for $\forall x \in \Bad, \exists y \in \Safe$ such that $x \longrightarrow^{*} y$ (resp.  $\forall x \in \Bad, \exists y \in \Safe$ such that $x \longrightarrow^{\leq k} y$). In our framework, $\Safe, \Bad \subseteq S$  are possibly infinite but they must admit a computable finite representation : for example, downward-closed sets and upward-closed sets in wqo and semilinear sets in $\mathbb{N}^d$ have finite representations. 
%	If $\Safe = S \backslash \Bad$, then $\Safe$ is downward-closed iff $\Bad$ is upward-closed. 
Let us formalize three resilience problems.

\problemx{resilience problem (RP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and two sets $\Safe, \Bad \subseteq S$.}
{$\Bad \longrightarrow^{*} \Safe$ ?\newline}
%
%\alain{il faudrait ne pas répéter 3 fois les mêmes imputs pour les 3 pbs: énoncer les 3 uniformes pbs d'un coup avec une fois l'input puis les 3 pbs pour un état s donné sans répéter non plus 3 fois les mêmes inputs}

%We add a third problem that decides whether there exists an $k$ such  that the system is $k$-resilient.
%

\problemx{$k$-resilience problem (kRP)}
{A transition system $\mathscr{S}=(S,\rightarrow), k \in \mathbb{N}$ and two sets $\Safe, \Bad \subseteq S$.}
{$\Bad \longrightarrow^{\leq k} \Safe$ ?\newline}

\problemx{bounded resilience problem (BRP)}
{A transition system $\mathscr{S}=(S,\rightarrow)$ and two sets $\Safe, \Bad \subseteq S$.}
%{$\exists k \geq 0 ~ \forall s' \in D ~ s \rightarrow^* s' \implies \exists s'' \in U ~ s' \rightarrow^{\leq k} s''$ ?\newline}
{$\exists k \geq 0$ such that $\mathscr{S}$ is %uniformely
 $k$-resilient ?\newline}


% \alain{dessous: à dire mais pas sous forme de proposition}
\begin{remark}[Reformulation]\label{reformulation}
$\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Bad,\Safe)-resilient iff $\Bad \subseteq \pred^*(\Safe)$.\\
$\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Bad,\Safe)-$k$-resilient iff $\Bad \subseteq \pred^{\leq k}(\Safe)$.
\end{remark}

These three resilience problems are decidable for finite transition systems but undecidable for (general) infinite-state transition systems. So we restrict our framework to the class of infinite-state WSTS. Since most of decidable properties in WSTS rely on the computation of upward or downward closed sets \cite{DBLP:journals/iandc/AbdullaCJT00, DBLP:journals/tcs/FinkelS01}, we consider upward closed or downward closed sets $\Safe$ and $\Bad$.

Surprinsingly, the decidability of resilience problems was not studied in the previous papers.

In \cite{DBLP:journals/corr/abs-2108-00889}, the authors considered that $\Bad$ is downward closed and $\Safe$ is upward closed.
%		
We deduce 
% \textcolor{red}{that the three resilience problems are decidable for all four pairs of sets $\Safe$ and $\Bad$ downward closed and upward closed sets.}
% \mathieu{changer ça}
decidability results for the four pairs of sets $\Safe$ and $\Bad$ downward closed and upward closed as seen in Section~\ref{synthesis}.

In particular, the existing proofs of resilience use the decidability of reachability; but we wish to decide resilience for models with undecidable reachability.
%

%	 and ideals are recursive 





\iffalse

\begin{proposition}\label{general}
\textcolor{red}{
$\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Bad,\Safe)-bounded-resilient iff $\mathscr{S}=(S,\rightarrow,\leq)$ is %uniformely 
(\Bad,\Safe)-resilient (CONJECTURE FOR NOW)
}
\end{proposition}

\begin{proof}
Resilient means that ...
\end{proof}

\fi

\begin{example}
% Avec Safe = up( q_1(3,0) ) et Bad = q_0 (N,N) on aurait la 1-résilience et donc la résilience par exemple
% mais avec Safe = up(q_0(3,0)) et Bad = q_1(N,N) on ne l'aurait pas à cause de q_1(0,0) 
Let $V = (\{q_0,q_1\}, \{ (q_0, (3,0), q_1), (q_1, (-1,1), q_0)\})$ be a vector addition system with states (VASS),
and thus a WSTS (see Figure~\ref{example_1}).
In the case $\Safe = \uparrow q_1(3,0)$ and $\Bad = \uparrow q_0(0,0)$, $1$-resilience holds.
On the other hand in the case $\Safe = \uparrow q_0(3,0)$ and $\Bad = \uparrow q_1(0,0)$, resilience does not hold because of $q_1(0,0) \in \Bad$.
% (si on veut se rajouter une hypothèse comme pas de dead-end on peut rajouter un troisième état q_2 duquel on puisse partir depuis q_1 en faisant par exemple +1,+1 et qui loop sur lui-même) 
\end{example}

\begin{center}
	\begin{figure}
			\hspace{3.75cm}
				\label{example_1}
\includegraphics[width=0.2\textwidth]{FigureA}
	\caption{}
	\end{figure}
\end{center}






\begin{example}
% Si on prends un Z-vass avec même seulement un compteur, Safe les entiers positifs, Bad le reste, avec juste une transition qui fait +1, alors on a la résilience (on reviens toujours dans les positifs) mais pas la bounded resilience.
Let us consider now a $\mathds{Z}$-VASS with only one state, one counter, and one transition that adds $+1$ to the counter, with $\Safe = \uparrow q(0)$, $\Bad = \downarrow q(-1)$,
then resilience hold (one always ends up in the positive integers) but not bounded resilience
(for every bound $b$ there is an element of $\Bad$ e.g. $q(-b-1)$ which necessitate at least $b+1$ steps before it can reach $\Safe$). 
\end{example}


\input{resilience-safe-up}

\input{resilience-safe-down}


{\bf Synthesis of the main results}\label{synthesis}

% \mathieu{En rouge quand il s'agit de conjectures}


\alain{simplifier le tableau en enlevant les deux dernières colonnes}
\begin{center}
\begin{tabular}{ | l | c | c | c | r |}
\hline   \Safe~\Bad & $\uparrow$~ $\uparrow$~ & $\uparrow$~ $\downarrow$~ & $\downarrow$~ $\uparrow$~ & $\downarrow$~ $\downarrow$~ \\ \hline
   RP & Decidable (Thm~\ref{up-up}) & Decidable (Thm~\ref{down-up})  & Decidable (Thm~\ref{up-down}) & Undecidable (Thm~\ref{down-down}) \\ \hline
   BRP & Decidable (Corollary~\ref{B-up-up}) &  Decidable (Thm~\ref{down-up}) & ?? & ?? \\ \hline
      kRP & Decidable (Thm~\ref{k-up-up}) & Decidable (Thm~\ref{down-up}) & ?? & ?? \\ \hline
 \end{tabular}
\end{center}




%We first assume that the safety property is given by an upward-closed set and the bad condition by a decidable downward-closed set. 
% \textcolor{red}{Seems like a reasonable assumption to me.}

%From these considerations, we formulate instances of the abstract resilience problems for well-
%structured transition systems.


