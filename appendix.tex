

\section{Resilience when $\Safe$ and $\Bad$ have the same closure properties}

We relax now the hypothesis that $\Bad$ is the complement of $\Safe$. In this appendix it is thus possible for $\Safe$ and $\Bad$ to share closure properties, i.e. for them to be both downward-closed or upward-closed. We will now explore both possiblities.


\subsection{Case: $\Bad=\downarrow \Bad$ and $\Safe=\downarrow \Safe$}\label{case down down}

% In the case \Safe and \Bad are both downward-closed, they can both be finite.
We start with the case $\Safe = \downarrow \Safe$ and $\Bad = \downarrow \Bad$.
%
Unfortunately, in this case the resilience problem is undecidable.

\begin{theorem}\label{down-down}
{\sc Resilience} is undecidable for  effective WSTS with  strong  compatibility such that
%	with more than one minimal element, 
$\Safe=\downarrow \Safe$
and $\Bad=\downarrow \Bad$.
\end{theorem}

\begin{proof}
If the set $S$ of a WSTS $\mathscr{S}=(S,\rightarrow, \leq)$ has an unique minimal element $m$, then $m$ belongs to both $\Safe$ and $\Bad$ which contradicts the assumption $\Safe \cap \Bad= \emptyset$. So let us consider the case of a set $S$ with at least two minimal elements $m_1$ and $m_2$.
The problem of whether $m_2$ is reachable from $m_1$ reduces itself to the resilience problem by considering $\Safe=\downarrow m_2 = \{ m_2\}$ and $\Bad=\downarrow m_1 = \{ m_1\}$. By undecidability of the reachability problem for effective WSTS with strong compatibility we conclude.  
\end{proof}


\subsection{Case: $\Bad=\uparrow \Bad$ and $\Safe=\uparrow \Safe$.}\label{case up up}


% \alain{2 clos par le haut ont une intersection non vide....}

We now consider the case where $\Safe = \uparrow \Safe$ and $\Bad$ is not the complement of 
$\Safe$ and we'd want $\Bad$ to have the same closure properties as $\Safe$.
We still however maintain the hypothesis that $\Bad \cap \Safe = \emptyset$, thus the conditions 
$\Safe = \uparrow \Safe$ and $\Bad = \uparrow \Bad$ would lead to a contradiction, since two upward-closed sets have not an empty intersection. We consider instead the case where $\Bad$ is as upward-closed
as it can be without intersecting with $\Safe$,
i.e. 
such that there exists an upward-closed set $U$
such that $\Bad = U \setminus \Safe$.



\begin{theorem}\label{up-up}
{\sc Resilience} is decidable for effective WSTS with effective pred-basis, $\Safe=\uparrow \Safe$
and $\Bad= U \setminus \Safe$ with $U = \uparrow U$.
\end{theorem}


\begin{proof}
Since $\Safe=\uparrow \Safe$ is upward-closed, there exists a finite basis $B_{ \Safe}$ such that $\uparrow \Safe = \uparrow B_{\Safe}$. 
Moreover since $\mathscr{S}=(S,\rightarrow,\leq)$ is a WSTS,  $\pred^*(\Safe)=\uparrow \pred^*(\Safe)$ and $\pred^*(\Safe)$ admits a finite basis $B_{\pred^*(\Safe)}$. Since $\mathscr{S}=(S,\rightarrow,\leq)$ is a WSTS  with effective pred-basis, we may compute a finite basis of $\pred^*(\Safe)$ with the backward coverability algorithm. 
Since $U$  is upward-closed, there exists a finite basis $B_{U}$ such that $U = \uparrow B_{U}$. % Moreover $ \uparrow B_{\Bad} \subseteq \uparrow B_{\pred^*(\Safe)}$ iff for every $b \in B_{\Bad}$, there is a $s \in B_{\pred^*(\Safe)}$ such that $s \leq b$.
Since $\Bad = U \setminus \Safe$, $\Bad \subseteq \uparrow B_{\pred^*(\Safe)}$ iff for every $b \in B_{U}$, there is either $s \in B_{\pred^*(\Safe)}$ such that $s \leq b$, either $t \in B_{\Safe}$ such that $t\leq b$,
% si on est dans up Bad, il faut que ou bien on soit dans pred(Safe) ou bien on soit dans Safe
hence the resilience problem is decidable.
\end{proof}

\begin{proposition}
In WSTS with strong compatibility and effective pred-basis,  $\Safe=\uparrow \Safe$, the {\sc Bounded resilience} is equivalent to {\sc Resilience}.
\end{proposition}

\begin{proof}
Since $\Safe=\uparrow \Safe$ and
$\mathscr{S}=(S,\rightarrow,\leq)$ is a WSTS with strong %upward-
compatibility, then $\pred^{\leq n}(\Safe)= \uparrow~\pred^{\leq n}(\Safe)$ for all $n \in \N$,
% \alain{$\pred^n$ ou $\pred^{\leq n}$ ? même question pour post. et où est-ce défini ?}
and there exists $n_0 \in \N$ such that 
$\pred^{\leq n_0}(\Safe) = \uparrow \pred^{\leq n_0}(\Safe) = \uparrow \pred^*(\Safe) = \pred^*(\Safe)$.
Hence the equivalence.
\end{proof}

\begin{corollary}\label{B-up-up}
{\sc Bounded resilience}  is decidable for WSTS with effective pred-basis,
strong compatibility
 $\Safe=\uparrow \Safe$
and $\Bad=U \setminus \Safe$ with $U = \uparrow U$.
\end{corollary}


\begin{theorem}\label{k-up-up}
{\sc $k$-resilience}  is decidable for WSTS with effective pred-basis, strong %upward-
compatibility, $\Safe=\uparrow \Safe$
and $\Bad=U \setminus \Safe$  with $U = \uparrow U$.
%	and \Bad is upward-closed or downward-closed.
\end{theorem}

\begin{proof}
Since $\Safe=\uparrow \Safe$ is upward-closed, there exists a finite basis $B_{ \Safe}$ such that $\uparrow \Safe = \uparrow B_{\Safe}$. 
Moreover since $\mathscr{S}=(S,\rightarrow,\leq)$ is a WSTS with strong (upward) compatibility,  $\pred^{\leq n}(\Safe)=\uparrow \pred^{\leq n}(\Safe)$ for all $n\in \N$ and $\pred^{\leq k}(\Safe)$ admits a finite basis $B_{\pred^{\leq k}(\Safe)}$. % Since $\mathscr{S}=(S,\rightarrow,\leq)$ is a WSTS  with effective pred-basis, we may compute a finite basis of $\pred^{\leq k}(\Safe)$ with the backward coverability algorithm. 
Since $U$  is upward-closed, there exists a finite basis $B_{U}$ such that $U = \uparrow B_{U}$. % Moreover $ \uparrow B_{\Bad} \subseteq \uparrow B_{\pred^{\leq k}(\Safe)}$ iff for every $b \in B_{\Bad}$, there is a $s \in B_{\pred^*(\Safe)}$ such that $s \leq b$.
Since $\Bad = U \setminus \Safe$, $\Bad \subseteq \uparrow B_{\pred^{\leq k}(\Safe)}$ iff for every $b \in B_{U}$, there is either $s \in B_{\pred^{\leq k}(\Safe)}$ such that $s \leq b$, either $t \in B_{\Safe}$ such that $t\leq b$,
% si on est dans up Bad, il faut que ou bien on soit dans pred(Safe) ou bien on soit dans Safe
hence the resilience problem is decidable.
\end{proof}








